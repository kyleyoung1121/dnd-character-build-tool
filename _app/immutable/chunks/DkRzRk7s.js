import{g as h}from"./BGP3eZCr.js";import{c as k}from"./C9Fx77Xw.js";function m(){const e=h(k),t=[];if(!e._provenance)return{hasConflicts:!1,conflicts:[],tabsNeedingAttention:[]};const n={skill:{},proficiency:{},language:{},feature:{}};for(const[i,s]of Object.entries(e._provenance)){const a="_set"in s&&s._set?s._set:s;if(a)for(const[c,l]of Object.entries(a)){if(!Array.isArray(l))continue;let r;switch(c){case"skills":r="skill";break;case"proficiencies":r="proficiency";break;case"languages":r="language";break;case"features":r="feature";break;default:continue}for(const u of l)n[r][u]||(n[r][u]=[]),n[r][u].push(i)}}for(const[i,s]of Object.entries(n))for(const[a,c]of Object.entries(s))if(c.length>1){const l=y(c);t.push({type:i,value:a,sources:c,affectedTabs:l})}const o=[...new Set(t.flatMap(i=>i.affectedTabs||[]))];return{hasConflicts:t.length>0,conflicts:t,tabsNeedingAttention:o}}function y(e){const t=new Set,n=new Set;for(const s of e)s.startsWith("class:")||s.startsWith("feature:")&&g(s)?(t.add("class"),f(s)&&n.add("class")):s.startsWith("race:")||b(s)?(t.add("race"),d(s)&&n.add("race")):s.includes("background")&&(t.add("background"),n.add("background"));const o=Array.from(t),i=Array.from(n);return[...i,...o.filter(s=>!i.includes(s))]}function f(e){return/:\d+$/.test(e)&&(e.includes("Skill Proficiencies")||e.includes("Bonus Proficiencies")||e.includes("Expertise")||e.includes("college_of_lore"))}function d(e){return/:\d+$/.test(e)&&(e.includes("Tool Proficiency")||e.includes("Cantrip")||e.includes("Draconic Ancestry"))}function g(e){return e.includes("Skill Proficiencies")||e.includes("Skills")||e.includes("Bonus Proficiencies")||e.includes("Expertise")||e.includes("college_of_lore")}function b(e){return e.includes("Keen Senses")||e.includes("Fey Ancestry")||e.includes("Trance")||e.includes("Darkvision")||e.includes("Dwarven")||e.includes("Elven")||e.includes("Halfling")||e.includes("Draconic")||e.includes("Tool Proficiency")}function v(e){const t=e.sources.filter(n=>f(n)||d(n)||n.includes("background"));if(t.length===0)return null;for(const n of t){if(n.startsWith("class:")||g(n))return"class";if(n.startsWith("race:")||b(n))return"race";if(n.includes("background"))return"background"}return null}export{m as d,v as g};
