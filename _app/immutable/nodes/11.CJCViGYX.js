import"../chunks/DsnmJJEf.js";import"../chunks/CLB9eUYX.js";import{W as Ks,ar as P,as as js,X as x,Y as g,Z as Vs,d as e,$ as L,j as q,z as E,_ as F,al as be,v as h,a0 as A,ay as G,au as K,l as Z,ax as ce,aO as Ie}from"../chunks/rn6nHgdH.js";import{a as O,e as De}from"../chunks/ZJQv4x7Q.js";import{i as T}from"../chunks/Co363syM.js";import{e as es,i as ss}from"../chunks/CAQU5EIs.js";import{C as zs,h as vs}from"../chunks/BeNoI1Wt.js";import{s as Me}from"../chunks/CHpWTfCS.js";import{i as Xs}from"../chunks/hD6VUnFp.js";import{s as Zs,a as Js}from"../chunks/Cb9z2JfB.js";import{c as Qs,h as ts}from"../chunks/CIqA3WZi.js";import{a as Is}from"../chunks/Dnzb4z2X.js";import{a as $,g as se,s as hs}from"../chunks/u1FZ14JW.js";function ds(Be){return function(...Re){var Ue=Re[0];return Ue.stopPropagation(),Be?.apply(this,Re)}}var et=x(`<div class="no-spells svelte-1yii93u"><h2 class="svelte-1yii93u">ðŸš« No Spell Access</h2> <p>Your current class and race combination doesn't grant access to spells. Choose a
				spellcasting class or subclass to unlock the Spells tab!</p></div>`),st=x("<button> </button>"),tt=x('<span class="selection-count svelte-1yii93u"><!></span>'),rt=x('<p class="section-description svelte-1yii93u"> </p>'),lt=x('<p class="section-description svelte-1yii93u">Cantrips are simple spells that you can cast at will, without expending spell slots.</p>'),ot=x(`<p class="section-description svelte-1yii93u">First-level spells require spell slots to cast. You regain all spell slots on a long
								rest.</p>`),at=x(`<p class="section-description svelte-1yii93u">Second-level spells require spell slots to cast. You regain all spell slots on a
								long rest.</p>`),nt=x('<h4 class="spell-subsection-header svelte-1yii93u"> </h4> <!>',1),ct=x('<span class="auto-granted-indicator svelte-1yii93u">âœ“</span>'),it=x('<span class="spell-tag racial-tag svelte-1yii93u"> </span>'),ut=x("<span> <!></span>"),ft=x('<span class="spell-tag patron-tag svelte-1yii93u">PATRON</span>'),pt=x('<button class="spell-button duplicate-button svelte-1yii93u" disabled>Duplicate</button>'),vt=x('<span class="spell-status unavailable-status svelte-1yii93u"> </span>'),ht=x('<span class="spell-status unavailable-status svelte-1yii93u">Already Known</span>'),dt=x('<button class="spell-button delete-button svelte-1yii93u">Delete</button>'),mt=x('<button class="spell-button learn-button svelte-1yii93u"> </button>'),bt=x('<span class="spell-status unavailable-status svelte-1yii93u">Duplicate</span>'),St=x('<div class="spell-higher-level svelte-1yii93u"><strong>At Higher Levels:</strong> <!></div>'),gt=x('<div class="spell-details svelte-1yii93u"><div class="spell-level-school svelte-1yii93u"> </div> <div class="spell-meta svelte-1yii93u"><div><strong class="svelte-1yii93u">Casting Time:</strong> </div> <div><strong class="svelte-1yii93u">Range/Area:</strong> </div> <div><strong class="svelte-1yii93u">Components:</strong> </div> <div><strong class="svelte-1yii93u">Duration:</strong> </div></div> <div class="spell-description svelte-1yii93u"><!></div> <!></div>'),Ct=x('<div><div class="spell-header svelte-1yii93u" role="button" tabindex="0"><div class="spell-title-section svelte-1yii93u"><!> <span> </span> <!> <!></div> <!> <span class="expand-icon svelte-1yii93u"> </span></div> <!></div>'),_t=x('<!> <div class="spell-list svelte-1yii93u"></div>',1),Nt=x('<div class="spell-section svelte-1yii93u"><h3 class="svelte-1yii93u"> <!></h3> <!> <!></div>'),yt=x('<div class="spell-tabs svelte-1yii93u"></div> <!>',1),At=x('<div class="main-content svelte-1yii93u"><!> <!></div>');function Ot(Be,Re){Ks(Re,!1);const[Ue,ms]=Zs(),Ee=()=>Js(Qs,"$character_store",Ue),S=E(),Ye=E(),He=E(),Ge=E(),Ke=E(),C=E(),bs=E(),Se=E(),ie=E(),ue=E(),Y=E(),rs=E(),ls=E(),os=E(),fe=E(),H=E(),je=E(),_=E();function Ss(s){return s.level===0?`${s.school} Cantrip`:`${s.level===1?"1st":s.level===2?"2nd":`${s.level}th`}-level ${s.school}`}function gs(s){return s.join(", ")}function as(s){return s.replace(/\n/g,"<br>")}function k(s,n){const v=$(n),r=[],i=se(s);return v.forEach(l=>{if(l.chooseFrom&&l.chooseFrom.length>0){if(l.maxSpellLevel!==void 0&&s>l.maxSpellLevel)return;l.chooseFrom.forEach(c=>{let u=i.filter(o=>o.classes.includes(c));l.restrictToSchools&&l.restrictToSchools.length>0&&(u=u.filter(o=>l.restrictToSchools.includes(o.school))),u.forEach(o=>{r.find(a=>a.name===o.name&&a.sourceName===l.sourceName)||r.push({...o,source:l.source,sourceName:l.sourceName,chooseable:l.chooseable!==!1})})})}l.spells&&s>0&&l.spells.forEach(c=>{const u=hs.find(o=>o.name===c&&o.level===s);if(u){const o=r.find(p=>p.name===u.name),a=l.source==="subclass"&&(l.sourceName==="The Archfey"||l.sourceName==="The Fiend"||l.sourceName==="The Great Old One");o?l.source==="subclass"&&(l.sourceName.includes("Oath")||l.sourceName.includes("Circle of the Land")||l.sourceName.includes("Domain"))&&o.source==="class"&&(o.source=l.source,o.sourceName=l.sourceName,o.chooseable=l.chooseable!==!1):r.push({...u,source:a?"class":l.source,sourceName:a?"Warlock":l.sourceName,chooseable:l.chooseable!==!1})}}),l.cantrips&&s===0&&l.cantrips.forEach(c=>{const u=hs.find(o=>o.name===c&&o.level===0);if(u){const o=r.find(p=>p.name===u.name),a=l.source==="subclass"&&(l.sourceName==="The Archfey"||l.sourceName==="The Fiend"||l.sourceName==="The Great Old One");o?l.source==="subclass"&&(l.sourceName.includes("Oath")||l.sourceName.includes("Circle of the Land")||l.sourceName.includes("Domain"))&&o.source==="class"&&(o.source=l.source,o.sourceName=l.sourceName,o.chooseable=l.chooseable!==!1):r.push({...u,source:a?"class":l.source,sourceName:a?"Warlock":l.sourceName,chooseable:l.chooseable!==!1})}})}),r.sort((l,c)=>{const u=l.classes.includes("Warlock"),o=c.classes.includes("Warlock");if(u&&o){const a=["Faerie Fire","Sleep","Calm Emotions","Phantasmal Force","Burning Hands","Command","Blindness/Deafness","Scorching Ray","Dissonant Whispers","Tasha's Hideous Laughter","Detect Thoughts"],p=a.includes(l.name),t=a.includes(c.name);if(p&&!t)return-1;if(!p&&t)return 1}return l.name.localeCompare(c.name)}),r}function Cs(s){const n=$(s),v={cantrips:0,level1:0,level2:0,sharedLeveled:0,isSharedLimits:!1};return n.forEach(r=>{if(r.chooseable!==!1){const i=r.source==="class"||r.source==="subclass"&&!r.sourceName.includes(" - ");if(r.chooseCantripCount!==void 0||r.chooseSpellCount!==void 0){if(r.chooseFrom&&r.chooseFrom.length>0){const l=se(0).some(o=>r.chooseFrom.some(a=>o.classes.includes(a))),c=(r.maxSpellLevel===void 0||r.maxSpellLevel>=1)&&se(1).some(o=>r.chooseFrom.some(a=>o.classes.includes(a))),u=(r.maxSpellLevel===void 0||r.maxSpellLevel>=2)&&se(2).some(o=>r.chooseFrom.some(a=>o.classes.includes(a)));l&&r.chooseCantripCount!==void 0&&i&&(v.cantrips+=r.chooseCantripCount),r.chooseSpellCount!==void 0&&i&&(c&&u?(v.isSharedLimits=!0,v.sharedLeveled+=r.chooseSpellCount):(c&&(v.level1+=r.chooseSpellCount),u&&(v.level2+=r.chooseSpellCount)))}}else if(r.chooseCount&&i&&r.chooseFrom&&r.chooseFrom.length>0){const l=se(0).some(o=>r.chooseFrom.some(a=>o.classes.includes(a))),c=(r.maxSpellLevel===void 0||r.maxSpellLevel>=1)&&se(1).some(o=>r.chooseFrom.some(a=>o.classes.includes(a))),u=(r.maxSpellLevel===void 0||r.maxSpellLevel>=2)&&se(2).some(o=>r.chooseFrom.some(a=>o.classes.includes(a)));l&&(v.cantrips+=r.chooseCount),c&&u?(v.isSharedLimits=!0,v.sharedLeveled+=r.chooseCount):(c&&(v.level1+=r.chooseCount),u&&(v.level2+=r.chooseCount))}}}),v}let d=E(new Map),J=E(new Set),b=E("");function ns(s,n,v){if(!n||!e(d).has(s)&&!us(e(b),v))return;const r=e(b),i=r.startsWith("subclass-")?r.replace("subclass-",""):r.startsWith("race-")?r.replace("race-",""):r.startsWith("feature-")?r.replace("feature-",""):r;if(e(d).has(s))e(d).delete(s);else{const l=Ee();e(d).set(s,{tabSource:i,charClass:l.class||"",charSubclass:l.subclass||"",charRace:l.race||"",charSubrace:l.subrace||""})}q(d,e(d)),is()}function cs(s){e(J).has(s)?e(J).delete(s):e(J).add(s),q(J,e(J))}function is(){const s="spell_selections",n={spells:Array.from(e(d).entries()).map(([v,r])=>({name:v,...r}))};Is(s,n)}function _s(){const s=Ee();if(!s._provenance)return;const v=s._provenance["spell_selections"];if(v){const r=v._set||v;r.spells&&Array.isArray(r.spells)&&(q(d,new Map),r.spells.forEach(i=>{typeof i=="string"?e(d).set(i,{tabSource:"",charClass:s.class||"",charSubclass:s.subclass||"",charRace:s.race||"",charSubrace:s.subrace||""}):i&&i.name&&(i.tabSource!==void 0?e(d).set(i.name,{tabSource:i.tabSource||"",charClass:i.charClass||"",charSubclass:i.charSubclass||"",charRace:i.charRace||"",charSubrace:i.charSubrace||""}):e(d).set(i.name,{tabSource:i.source||"",charClass:s.class||"",charSubclass:s.subclass||"",charRace:s.race||"",charSubrace:s.subrace||""}))}))}}function Ns(s,n){if(s===0)return"Learn";const v=n.class;return v&&["Cleric","Druid","Paladin"].includes(v)?"Prepare":"Learn"}function ys(s){const n=$(s),v=[];n.forEach(t=>{t.source==="race"&&(t.spells&&t.spells.length>0||t.cantrips&&t.cantrips.length>0||t.chooseFrom&&t.chooseFrom.length>0)&&v.push({id:`${t.source}-${t.sourceName}`,name:t.sourceName,type:"race",sourceName:t.sourceName,requiresChoices:t.chooseable===!0})});const r=new Map;n.forEach(t=>{if(t.source==="subclass"&&(t.spells&&t.spells.length>0||t.cantrips&&t.cantrips.length>0||t.chooseFrom&&t.chooseFrom.length>0)){const y=r.get(t.sourceName);y?y.requiresChoices=y.requiresChoices||t.chooseable===!0:r.set(t.sourceName,{id:`${t.source}-${t.sourceName}`,name:t.sourceName,type:"subclass",sourceName:t.sourceName,requiresChoices:t.chooseable===!0})}}),r.forEach(t=>{v.push(t)}),n.forEach(t=>{t.source==="feature"&&(t.spells&&t.spells.length>0||t.cantrips&&t.cantrips.length>0||t.chooseFrom&&t.chooseFrom.length>0)&&v.push({id:`${t.source}-${t.sourceName}`,name:t.sourceName,type:"feature",sourceName:t.sourceName,requiresChoices:t.chooseable===!0})});const i=n.filter(t=>t.source==="subclass"&&t.chooseable&&(t.chooseCantripCount??0)>0&&(t.chooseSpellCount??0)>0).map(t=>t.sourceName),l=n.some(t=>(t.source==="class"||t.source==="subclass"&&!i.includes(t.sourceName)||t.source==="feature")&&t.chooseable&&((t.chooseCantripCount??0)>0||t.chooseFrom&&se(0).some(m=>t.chooseFrom.some(y=>m.classes.includes(y))))),c=n.some(t=>(t.source==="class"||t.source==="subclass"&&!i.includes(t.sourceName)||t.source==="feature")&&t.chooseable&&((t.chooseSpellCount??0)>0||t.chooseFrom&&se(1).some(m=>t.chooseFrom.some(y=>m.classes.includes(y))))),u=n.some(t=>(t.source==="class"||t.source==="subclass"&&!i.includes(t.sourceName)||t.source==="feature")&&t.chooseable&&((t.chooseSpellCount??0)>0||t.chooseFrom&&se(2).some(m=>t.chooseFrom.some(y=>m.classes.includes(y))))),a=!n.some(t=>t.source==="class"&&t.chooseable)&&n.some(t=>t.source==="subclass"&&t.chooseable);return l&&!a&&v.push({id:"cantrips",name:"Cantrips",type:"level",level:0,requiresChoices:!0}),c&&!a&&v.push({id:"level1",name:"1st Level",type:"level",level:1,requiresChoices:!0}),u&&v.push({id:"level2",name:"2nd Level",type:"level",level:2,requiresChoices:!0}),v.filter(t=>ke(s,t.id).length>0)}function ke(s,n){function v(r,i){const l=k(i,s).filter(o=>o.source==="race"&&!o.chooseable),c=r.map(o=>{const a=l.some(p=>p.name===o.name);return{...o,isRacialDuplicate:a,racialSource:a?l.find(p=>p.name===o.name)?.sourceName:null}}),u=l.filter(o=>!r.some(a=>a.name===o.name)).map(o=>({...o,isRacialDuplicate:!0,racialSource:o.sourceName,chooseable:!1}));return[...c,...u]}if(n==="cantrips"){const r=k(0,s).filter(i=>(i.source==="class"||i.source==="subclass"&&!i.sourceName.includes(" - "))&&i.source!=="feature");return v(r,0)}else if(n==="level1"){const r=k(1,s).filter(i=>(i.source==="class"||i.source==="subclass"&&!i.sourceName.includes(" - "))&&i.source!=="feature");return v(r,1)}else if(n==="level2"){const r=k(2,s).filter(i=>(i.source==="class"||i.source==="subclass"&&!i.sourceName.includes(" - "))&&i.source!=="feature");return v(r,2)}else if(n.startsWith("race-")){const r=n.replace("race-",""),l=$(s).find(c=>c.source==="race"&&c.sourceName===r);if(!l)return[];if(l.chooseable&&l.chooseFrom){const c=[];if((l.chooseCantripCount??0)>0){const u=k(0,s).filter(o=>o.source==="race"&&o.sourceName===r);c.push(...u)}if((l.chooseSpellCount??0)>0){const u=k(1,s).filter(a=>a.source==="race"&&a.sourceName===r),o=k(2,s).filter(a=>a.source==="race"&&a.sourceName===r);c.push(...u,...o)}return c}else{const c=k(0,s).filter(a=>a.source==="race"&&a.sourceName===r),u=k(1,s).filter(a=>a.source==="race"&&a.sourceName===r),o=k(2,s).filter(a=>a.source==="race"&&a.sourceName===r);return[...c,...u,...o]}}else if(n.startsWith("subclass-")){const r=n.replace("subclass-",""),l=$(s).filter(a=>a.source==="subclass"&&a.sourceName===r);if(l.length===0)return[];const c=l.reduce((a,p)=>a+(p.chooseCantripCount??0)+(p.cantrips?.length??0),0),u=l.reduce((a,p)=>a+(p.chooseSpellCount??0)+(p.spells?.length??0),0),o=[];if(c>0){const a=k(0,s).filter(p=>p.source==="subclass"&&p.sourceName===r).map(p=>({...p,spellSection:"cantrips"}));o.push(...a)}if(u>0){const a=k(1,s).filter(t=>t.source==="subclass"&&t.sourceName===r).map(t=>({...t,spellSection:"level1"})),p=k(2,s).filter(t=>t.source==="subclass"&&t.sourceName===r).map(t=>({...t,spellSection:"level2"}));o.push(...a,...p)}return o}else if(n.startsWith("feature-")){const r=n.replace("feature-","");if(!$(s).find(a=>a.source==="feature"&&a.sourceName===r))return[];const c=k(0,s).filter(a=>a.source==="feature"&&a.sourceName===r),u=k(1,s).filter(a=>a.source==="feature"&&a.sourceName===r),o=k(2,s).filter(a=>a.source==="feature"&&a.sourceName===r);return[...c,...u,...o]}return[]}function As(s){q(b,s)}function Ls(s,n){const v=ke(s,n);if(v.length===0)return!0;const r=v.filter(i=>i.chooseable);if(r.length===0)return!0;if(n.startsWith("race-")){const i=n.replace("race-",""),c=$(s).find(t=>t.source==="race"&&t.sourceName===i);if(!c||!c.chooseable)return!0;const u=r.filter(t=>e(d).has(t.name)?e(d).get(t.name)?.tabSource===i:!1).length,o=c.chooseCantripCount??0,a=c.chooseSpellCount??0,p=o+a;return u>=p}if(n.startsWith("subclass-")){const i=n.replace("subclass-",""),u=$(s).filter(m=>m.source==="subclass"&&m.sourceName===i).filter(m=>m.chooseable);if(u.length===0)return!0;const o=r.filter(m=>e(d).has(m.name)?e(d).get(m.name)?.tabSource===i:!1).length,a=u.reduce((m,y)=>m+(y.chooseCantripCount??0),0),p=u.reduce((m,y)=>m+(y.chooseSpellCount??0),0),t=a+p;return o>=t}if(n.startsWith("feature-")){const i=n.replace("feature-",""),c=$(s).find(t=>t.source==="feature"&&t.sourceName===i);if(!c||!c.chooseable)return!0;const u=r.filter(t=>e(d).has(t.name)?e(d).get(t.name)?.tabSource===i:!1).length,o=c.chooseCantripCount??0,a=c.chooseSpellCount??0,p=o+a;return u>=p}return n==="cantrips"?r.filter(l=>{if(!e(d).has(l.name))return!1;const c=e(d).get(l.name)?.tabSource;return!c||c==="cantrips"}).length>=e(C).cantrips:n==="level1"?e(C).isSharedLimits?e(Y)>=e(C).sharedLeveled:r.filter(l=>{if(!e(d).has(l.name))return!1;const c=e(d).get(l.name)?.tabSource;return!c||c==="level1"}).length>=e(C).level1:n==="level2"?e(C).isSharedLimits?e(Y)>=e(C).sharedLeveled:r.filter(l=>{if(!e(d).has(l.name))return!1;const c=e(d).get(l.name)?.tabSource;return!c||c==="level2"}).length>=e(C).level2:!1}function Fs(s,n){const r=ke(s,n).filter(l=>l.chooseable),i=r.filter(l=>e(d).has(l.name)).length;if(n.startsWith("race-")){const l=n.replace("race-",""),u=$(s).find(t=>t.source==="race"&&t.sourceName===l);if(!u||!u.chooseable)return null;const o=u.chooseCantripCount||0,a=u.chooseSpellCount||0,p=o+a;return{selected:i,total:p}}else if(n.startsWith("subclass-")){const l=n.replace("subclass-",""),o=$(s).filter(m=>m.source==="subclass"&&m.sourceName===l).filter(m=>m.chooseable);if(o.length===0)return null;const a=o.reduce((m,y)=>m+(y.chooseCantripCount||0),0),p=o.reduce((m,y)=>m+(y.chooseSpellCount||0),0),t=a+p;return{selected:i,total:t}}else if(n.startsWith("feature-")){const l=n.replace("feature-",""),u=$(s).find(m=>m.source==="feature"&&m.sourceName===l);if(!u||!u.chooseable)return null;const o=u.chooseCantripCount||0,a=u.chooseSpellCount||0,p=o+a;return{selected:r.filter(m=>e(d).has(m.name)?e(d).get(m.name)?.tabSource===l:!1).length,total:p}}else{if(n==="cantrips")return{selected:e(Se),total:e(C).cantrips};if(n==="level1")return e(C).isSharedLimits?{selected:e(Y),total:e(C).sharedLeveled,shared:!0}:{selected:e(ie),total:e(C).level1};if(n==="level2")return e(C).isSharedLimits?{selected:e(Y),total:e(C).sharedLeveled,shared:!0}:{selected:e(ue),total:e(C).level2}}return null}function xs(s){return s==="cantrips"?"Cantrips are simple spells that you can cast at will, without expending spell slots.":s==="level1"?"First-level spells require spell slots to cast. You regain all spell slots on a long rest.":s==="level2"?"Second-level spells require spell slots to cast. You regain all spell slots on a long rest.":s.startsWith("race-")?`Spells granted by your ${s.replace("race-","")} heritage.`:s.startsWith("subclass-")?`Spells granted by your ${s.replace("subclass-","")} features.`:s.startsWith("feature-")?`Spells granted by your ${s.replace("feature-","")} feature.`:""}function Ws(s,n){const v=new Set,r=$(s),i=n.startsWith("race-")?"race":n.startsWith("subclass-")?"subclass":n.startsWith("feature-")?"feature":"class",l=n.startsWith("race-")?n.replace("race-",""):n.startsWith("subclass-")?n.replace("subclass-",""):n.startsWith("feature-")?n.replace("feature-",""):n;r.forEach(c=>{if(!c.chooseable){const u=i==="class",o=c.source!==i||l&&c.sourceName!==l,a=u&&c.source==="subclass";(o||a)&&(c.spells&&c.spells.forEach(p=>v.add(p)),c.cantrips&&c.cantrips.forEach(p=>v.add(p)))}});for(let c=0;c<=2;c++){const u=k(c,s),o=new Map;u.forEach(a=>{o.has(a.name)||o.set(a.name,[]),o.get(a.name).push(a)}),o.forEach((a,p)=>{if(e(d).has(p)){if(e(d).get(p)?.tabSource===l)return;a.filter(y=>y.source===i&&(!l||y.sourceName===l)).length>0&&v.add(p)}})}return v}function us(s,n){if(s==="cantrips")return e(rs);if(s==="level1")return e(ls);if(s==="level2")return e(os);if(s.startsWith("race-")||s.startsWith("subclass-")||s.startsWith("feature-")){if(s===e(b)&&e(_)){if(e(_).cantrips&&e(_).spells&&n){if(n.spellSection==="cantrips")return e(_).cantrips.selected<e(_).cantrips.total;if(n.spellSection==="level1"||n.spellSection==="level2")return e(_).spells.selected<e(_).spells.total}return e(_).selected<e(_).total}const v=Fs(e(S),s);return v?v.selected<v.total:!1}return!1}function qs(s,n){const v=$(n);for(const r of v)if(!r.chooseable&&(r.spells&&r.spells.includes(s)||r.cantrips&&r.cantrips.includes(s)))return r.source==="subclass"&&r.sourceName.includes("Oath")?"Duplicate":r.source==="subclass"&&(r.sourceName.includes("Domain")||r.sourceName.includes("Circle"))?(r.sourceName.includes("Domain"),"Duplicate"):"Already Known";return"Already Known"}P(()=>Ee(),()=>{q(S,Ee())}),P(()=>e(S),()=>{q(Ye,$(e(S)))}),P(()=>e(S),()=>{q(He,e(S).class?k(0,e(S)):[])}),P(()=>e(S),()=>{q(Ge,e(S).class?k(1,e(S)):[])}),P(()=>e(S),()=>{q(Ke,e(S).class?k(2,e(S)):[])}),P(()=>e(S),()=>{q(C,Cs(e(S)))}),P(()=>e(S),()=>{e(S)&&(_s(),is())}),P(()=>(e(S),e(Ye)),()=>{q(bs,e(S).class?e(Ye).filter(s=>s.source==="subclass"&&s.chooseable&&(s.chooseCantripCount??0)>0&&(s.chooseSpellCount??0)>0).map(s=>s.sourceName):[])}),P(()=>(e(He),e(d)),()=>{q(Se,e(He).filter(s=>{if(!s.chooseable||!e(d).has(s.name)||s.source==="feature"||!(s.source==="class"||s.source==="subclass"&&!s.sourceName.includes(" - ")))return!1;const n=e(d).get(s.name);return!(n&&n.tabSource&&(n.tabSource.includes("Pact of the")||n.tabSource.startsWith("feature-")))}).length)}),P(()=>(e(Ge),e(d)),()=>{q(ie,e(Ge).filter(s=>{if(!s.chooseable||!e(d).has(s.name)||s.source==="feature"||!(s.source==="class"||s.source==="subclass"&&!s.sourceName.includes(" - ")))return!1;const n=e(d).get(s.name);return!(n&&n.tabSource&&(n.tabSource.includes("Pact of the")||n.tabSource.startsWith("feature-")))}).length)}),P(()=>(e(Ke),e(d)),()=>{q(ue,e(Ke).filter(s=>{if(!s.chooseable||!e(d).has(s.name)||s.source==="feature"||!(s.source==="class"||s.source==="subclass"&&!s.sourceName.includes(" - ")))return!1;const n=e(d).get(s.name);return!(n&&n.tabSource&&(n.tabSource.includes("Pact of the")||n.tabSource.startsWith("feature-")))}).length)}),P(()=>(e(ie),e(ue)),()=>{q(Y,e(ie)+e(ue))}),P(()=>(e(Se),e(C)),()=>{q(rs,e(Se)<e(C).cantrips)}),P(()=>(e(C),e(Y),e(ie)),()=>{q(ls,e(C).isSharedLimits?e(Y)<e(C).sharedLeveled:e(ie)<e(C).level1)}),P(()=>(e(C),e(Y),e(ue)),()=>{q(os,e(C).isSharedLimits?e(Y)<e(C).sharedLeveled:e(ue)<e(C).level2)}),P(()=>e(S),()=>{q(fe,ts(e(S))?ys(e(S)):[])}),P(()=>(e(fe),e(b)),()=>{e(fe).length>0&&(!e(b)||!e(fe).find(s=>s.id===e(b)))&&q(b,e(fe)[0].id)}),P(()=>(e(b),e(S)),()=>{q(H,e(b)?ke(e(S),e(b)):[])}),P(()=>(e(b),e(S)),()=>{q(je,e(b)?Ws(e(S),e(b)):new Set)}),P(()=>(e(b),e(H),e(d),e(S),e(Se),e(C),e(Y),e(ie),e(ue)),()=>{q(_,(()=>{if(!e(b))return null;const s=e(H),n=s.filter(r=>r.chooseable),v=n.filter(r=>e(d).has(r.name)).length;if(e(b).startsWith("race-")){const r=e(b).replace("race-",""),l=$(e(S)).find(a=>a.source==="race"&&a.sourceName===r);if(!l||!l.chooseable)return null;const c=l.chooseCantripCount??0,u=l.chooseSpellCount??0,o=c+u;return{selected:v,total:o}}else if(e(b).startsWith("subclass-")){const r=e(b).replace("subclass-",""),c=$(e(S)).filter(t=>t.source==="subclass"&&t.sourceName===r).filter(t=>t.chooseable);if(c.length===0)return null;const u=s.filter(t=>!t.chooseable).length,o=c.reduce((t,m)=>t+(m.chooseCantripCount??0),0),a=c.reduce((t,m)=>t+(m.chooseSpellCount??0),0),p=n.filter(t=>e(d).has(t.name)?e(d).get(t.name)?.tabSource===r:!1).length;if(o>0&&a>0){const t=s.filter(Q=>Q.spellSection==="cantrips"),m=s.filter(Q=>Q.spellSection==="level1"||Q.spellSection==="level2"),y=t.filter(Q=>e(d).has(Q.name)).length,Le=m.filter(Q=>e(d).has(Q.name)).length;return{selected:y+Le,total:o+a,cantrips:{selected:y,total:o},spells:{selected:Le,total:a}}}else{const t=o+a;return{selected:p+u,total:t+u}}}else if(e(b).startsWith("feature-")){const r=e(b).replace("feature-",""),l=$(e(S)).find(p=>p.source==="feature"&&p.sourceName===r);if(!l||!l.chooseable)return null;const c=l.chooseCantripCount??0,u=l.chooseSpellCount??0,o=c+u;return{selected:n.filter(p=>e(d).has(p.name)?e(d).get(p.name)?.tabSource===r:!1).length,total:o}}else{if(e(b)==="cantrips")return{selected:e(Se),total:e(C).cantrips};if(e(b)==="level1")return e(C).isSharedLimits?{selected:e(Y),total:e(C).sharedLeveled,shared:!0}:{selected:e(ie),total:e(C).level1};if(e(b)==="level2")return e(C).isSharedLimits?{selected:e(Y),total:e(C).sharedLeveled,shared:!0}:{selected:e(ue),total:e(C).level2}}return null})())}),js(),Xs();var Ve=At(),fs=L(Ve);zs(fs,{tabName:"spells"});var Ts=F(fs,2);{var Ds=s=>{var n=et();g(s,n)},Rs=s=>{var n=yt(),v=G(n);es(v,5,()=>e(fe),ss,(l,c)=>{var u=st();let o;var a=L(u,!0);A(u),K(p=>{o=Me(u,1,"tab-btn svelte-1yii93u",null,o,p),O(a,(e(c),h(()=>e(c).name)))},[()=>({active:e(b)===e(c).id,completed:Ls(e(S),e(c).id)})]),De("click",u,()=>As(e(c).id)),g(l,u)}),A(v);var r=F(v,2);{var i=l=>{var c=Nt();const u=Z(()=>(e(fe),e(b),h(()=>e(fe).find(D=>D.id===e(b))))),o=Z(()=>(e(b),e(H),h(()=>e(b).startsWith("subclass-")&&e(H).some(D=>D.spellSection)))),a=Z(()=>(be(e(o)),e(H),h(()=>e(o)?[{id:"cantrips",name:"Cantrips",spells:e(H).filter(D=>D.spellSection==="cantrips")},{id:"level1",name:"1st Level Spells",spells:e(H).filter(D=>D.spellSection==="level1")},{id:"level2",name:"2nd Level Spells",spells:e(H).filter(D=>D.spellSection==="level2")}].filter(D=>D.spells.length>0):[{id:"all",name:"",spells:e(H)}])));var p=L(c),t=L(p),m=F(t);{var y=D=>{var w=tt(),ge=L(w);{var Ce=te=>{var j=Ie();K(()=>O(j,`(Cantrips: ${e(_),h(()=>e(_).cantrips.selected)??""}/${e(_),h(()=>e(_).cantrips.total)??""}, Spells: ${e(_),h(()=>e(_).spells.selected)??""}/${e(_),h(()=>e(_).spells.total)??""})`)),g(te,j)},ze=te=>{var j=Ie();K(()=>O(j,`(${e(_),h(()=>e(_).selected)??""}/${e(_),h(()=>e(_).total)??""}
								${e(_),h(()=>e(_).shared?"total leveled spells":"")??""} selected)`)),g(te,j)};T(ge,te=>{e(_),h(()=>e(_).cantrips&&e(_).spells)?te(Ce):te(ze,!1)})}A(w),g(D,w)};T(m,D=>{e(_),h(()=>e(_)&&e(_).total>0)&&D(y)})}A(p);var Le=F(p,2);{var Q=D=>{var w=rt(),ge=L(w,!0);A(w),K(Ce=>O(ge,Ce),[()=>(e(b),h(()=>xs(e(b))))]),g(D,w)};T(Le,D=>{e(o)||D(Q)})}var Es=F(Le,2);es(Es,1,()=>e(a),ss,(D,w)=>{var ge=_t(),Ce=G(ge);{var ze=j=>{var f=nt(),pe=G(f),Fe=L(pe,!0);A(pe);var we=F(pe,2);{var he=re=>{var _e=lt();g(re,_e)},xe=re=>{var _e=ce(),Ne=G(_e);{var Pe=le=>{var ye=ot();g(le,ye)},Xe=le=>{var ye=ce(),Ze=G(ye);{var Je=We=>{var $e=at();g(We,$e)};T(Ze,We=>{e(w),h(()=>e(w).id==="level2")&&We(Je)},!0)}g(le,ye)};T(Ne,le=>{e(w),h(()=>e(w).id==="level1")?le(Pe):le(Xe,!1)},!0)}g(re,_e)};T(we,re=>{e(w),h(()=>e(w).id==="cantrips")?re(he):re(xe,!1)})}K(()=>O(Fe,(e(w),h(()=>e(w).name)))),g(j,f)};T(Ce,j=>{be(e(o)),e(w),h(()=>e(o)&&e(w).name)&&j(ze)})}var te=F(Ce,2);es(te,5,()=>(e(w),h(()=>e(w).spells)),ss,(j,f)=>{var pe=Ct();const Fe=Z(()=>(e(je),e(f),h(()=>e(je).has(e(f).name))));let we;var he=L(pe),xe=L(he),re=L(xe);{var _e=N=>{var W=ct();g(N,W)};T(re,N=>{e(f),h(()=>!e(f).chooseable)&&N(_e)})}var Ne=F(re,2);let Pe;var Xe=L(Ne,!0);A(Ne);var le=F(Ne,2);{var ye=N=>{var W=it(),M=L(W);A(W),K(V=>O(M,`${V??""} (AUTO)`),[()=>(e(f),h(()=>e(f).racialSource.toUpperCase()))]),g(N,W)},Ze=N=>{var W=ce(),M=G(W);{var V=B=>{var R=ut(),z=L(R),de=F(z);{var qe=X=>{var I=Ie("(AUTO)");g(X,I)};T(de,X=>{e(f),h(()=>!e(f).chooseable)&&X(qe)})}A(R),K(X=>{Me(R,1,`spell-tag ${e(f),h(()=>e(f).source)??""}`,"svelte-1yii93u"),O(z,`${X??""} `)},[()=>(e(f),h(()=>e(f).sourceName.toUpperCase()))]),g(B,R)};T(M,B=>{e(f),h(()=>e(f).source!=="class")&&B(V)},!0)}g(N,W)};T(le,N=>{e(f),h(()=>e(f).isRacialDuplicate&&e(f).racialSource)?N(ye):N(Ze,!1)})}var Je=F(le,2);{var We=N=>{var W=ce();const M=Z(()=>["Faerie Fire","Sleep","Calm Emotions","Phantasmal Force","Burning Hands","Command","Blindness/Deafness","Scorching Ray","Dissonant Whispers","Tasha's Hideous Laughter","Detect Thoughts"]);var V=G(W);{var B=R=>{var z=ft();g(R,z)};T(V,R=>{be(e(M)),e(f),h(()=>e(M).includes(e(f).name))&&R(B)})}g(N,W)};T(Je,N=>{e(f),h(()=>e(f).sourceName==="Warlock")&&N(We)})}A(xe);var $e=F(xe,2);{var ks=N=>{var W=ce(),M=G(W);{var V=R=>{var z=pt();g(R,z)},B=R=>{var z=ce(),de=G(z);{var qe=I=>{var oe=vt(),Te=L(oe,!0);A(oe),K(me=>O(Te,me),[()=>(e(f),e(S),h(()=>qs(e(f).name,e(S))))]),g(I,oe)},X=I=>{var oe=ce(),Te=G(oe);{var me=ve=>{var ee=ce();const ae=Z(()=>e(b)==="cantrips"||e(b)==="level1"||e(b)==="level2"),ne=Z(()=>(e(b),h(()=>e(b).startsWith("feature-")))),U=Z(()=>(e(d),e(f),h(()=>e(d).get(e(f).name)))),Ms=Z(()=>(be(e(U)),h(()=>e(U)&&e(U).tabSource&&e(U).tabSource.includes("Pact of the")))),Bs=Z(()=>(be(e(U)),h(()=>e(U)&&e(U).tabSource&&(e(U).tabSource==="cantrips"||e(U).tabSource==="level1"||e(U).tabSource==="level2")))),Us=Z(()=>e(ae)&&e(Ms)||e(ne)&&e(Bs));var Ys=G(ee);{var Hs=Ae=>{var Oe=ht();g(Ae,Oe)},Gs=Ae=>{var Oe=dt();De("click",Oe,ds(()=>ns(e(f).name,e(f).chooseable,e(f)))),g(Ae,Oe)};T(Ys,Ae=>{e(Us)?Ae(Hs):Ae(Gs,!1)})}g(ve,ee)},Qe=ve=>{var ee=mt(),ae=L(ee,!0);A(ee),K((ne,U)=>{ee.disabled=ne,O(ae,U)},[()=>(e(b),e(f),h(()=>!us(e(b),e(f)))),()=>(e(f),e(S),h(()=>Ns(e(f).level,e(S))))]),De("click",ee,ds(()=>ns(e(f).name,e(f).chooseable,e(f)))),g(ve,ee)};T(Te,ve=>{e(d),e(f),h(()=>e(d).has(e(f).name))?ve(me):ve(Qe,!1)},!0)}g(I,oe)};T(de,I=>{e(Fe)?I(qe):I(X,!1)},!0)}g(R,z)};T(M,R=>{e(f),h(()=>e(f).isRacialDuplicate)?R(V):R(B,!1)})}g(N,W)},ws=N=>{var W=ce(),M=G(W);{var V=B=>{var R=bt();g(B,R)};T(M,B=>{e(Fe)&&B(V)},!0)}g(N,W)};T($e,N=>{e(f),h(()=>e(f).chooseable)?N(ks):N(ws,!1)})}var ps=F($e,2),Ps=L(ps,!0);A(ps),A(he);var $s=F(he,2);{var Os=N=>{var W=gt(),M=L(W),V=L(M,!0);A(M);var B=F(M,2),R=L(B),z=F(L(R));A(R);var de=F(R,2),qe=F(L(de));A(de);var X=F(de,2),I=F(L(X));A(X);var oe=F(X,2),Te=F(L(oe));A(oe),A(B);var me=F(B,2),Qe=L(me);vs(Qe,()=>(e(f),h(()=>as(e(f).description)))),A(me);var ve=F(me,2);{var ee=ae=>{var ne=St(),U=F(L(ne),2);vs(U,()=>(e(f),h(()=>as(e(f).higherLevel)))),A(ne),g(ae,ne)};T(ve,ae=>{e(f),h(()=>e(f).higherLevel)&&ae(ee)})}A(W),K((ae,ne)=>{O(V,ae),O(z,` ${e(f),h(()=>e(f).castingTime)??""}`),O(qe,` ${e(f),h(()=>e(f).range)??""}`),O(I,` ${ne??""}`),O(Te,` ${e(f),h(()=>e(f).duration)??""}`)},[()=>(e(f),h(()=>Ss(e(f)))),()=>(e(f),h(()=>gs(e(f).components)))]),g(N,W)};T($s,N=>{e(J),e(f),h(()=>e(J).has(e(f).name))&&N(Os)})}A(pe),K((N,W,M)=>{we=Me(pe,1,"spell-card svelte-1yii93u",null,we,N),Pe=Me(Ne,1,"spell-name svelte-1yii93u",null,Pe,W),O(Xe,(e(f),h(()=>e(f).name))),O(Ps,M)},[()=>({special:e(f).source!=="class","auto-granted":!e(f).chooseable,unavailable:e(Fe),expanded:e(J).has(e(f).name)}),()=>({"racial-duplicate":e(f).isRacialDuplicate}),()=>(e(J),e(f),h(()=>e(J).has(e(f).name)?"âˆ’":"+"))]),De("click",he,()=>cs(e(f).name)),De("keydown",he,N=>N.key==="Enter"&&cs(e(f).name)),g(j,pe)}),A(te),g(D,ge)}),A(c),K(()=>O(t,`${be(e(u)),h(()=>e(u)?.name||"Spells")??""} `)),g(l,c)};T(r,l=>{e(b),e(H),h(()=>e(b)&&e(H).length>0)&&l(i)})}g(s,n)};T(Ts,s=>{be(ts),e(S),h(()=>!ts(e(S)))?s(Ds):s(Rs,!1)})}A(Ve),g(Be,Ve),Vs(),ms()}export{Ot as component};
