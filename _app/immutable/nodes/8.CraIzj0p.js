import"../chunks/DsnmJJEf.js";import"../chunks/CQMj6I71.js";import{a as E}from"../chunks/CWh0W3WP.js";import{y as _,j as A,z as S,al as y,A as O,B as j,d as T,C as d,E as u,aj as $,F as k}from"../chunks/D8epjS11.js";import{g as p,e as b,s as I}from"../chunks/BiH1rH3r.js";import{i as P}from"../chunks/nRLFwT7N.js";import{c as f}from"../chunks/DANXc4Na.js";import{d as v}from"../chunks/wOBU2gXn.js";import{a as g}from"../chunks/CFTOOR2V.js";function C(){console.log("üß™ Testing Bard + High Elf Perception conflict scenario");const s=p(f);if(s._provenance)for(const o of Object.keys(s._provenance));console.log("1Ô∏è‚É£ Selecting Bard class..."),g("class:Bard",{class:"Bard"}),console.log("2Ô∏è‚É£ Selecting Perception as Bard skill..."),g("feature:Skill Proficiencies:0",{skills:["Perception"]});let t=p(f);console.log("After Bard selection:"),console.log("- Skills:",t.skills),console.log("- Provenance keys:",Object.keys(t._provenance||{})),console.log("3Ô∏è‚É£ Selecting High Elf race..."),g("race:High Elf",{race:"High Elf"}),console.log("4Ô∏è‚É£ Applying High Elf Keen Senses..."),g("feature:Keen Senses",{skills:["Perception"]});let c=p(f);console.log("After High Elf selection:"),console.log("- Skills:",c.skills),console.log("- Provenance keys:",Object.keys(c._provenance||{})),console.log("5Ô∏è‚É£ Running conflict detection...");const e=v();if(console.log("Conflicts detected:",e),e.hasConflicts){console.log("‚úÖ SUCCESS: Conflict detected!");for(const o of e.conflicts)console.log(`- ${o.type}: ${o.value} (sources: ${o.sources.join(", ")})`),console.log(`- Affected tabs: ${o.affectedTabs?.join(", ")||"none"}`)}else console.log("‚ùå FAILURE: No conflicts detected");return e}typeof window<"u"&&(window.testBardHighElfConflict=C);function B(){const s=p(f);if(console.log("=== CHARACTER STORE DEBUG ==="),console.log("Skills array:",s.skills),console.log("Provenance data:",s._provenance),s._provenance){console.log(`
=== PROVENANCE ANALYSIS ===`);for(const[e,o]of Object.entries(s._provenance))console.log(`
Scope: ${e}`),"_set"in o&&o._set?(console.log("  _set:",o._set),o._set.skills&&console.log(`  ‚Üí Added skills: [${o._set.skills.join(", ")}]`)):(console.log("  Flat format:",o),o.skills&&console.log(`  ‚Üí Added skills: [${o.skills.join(", ")}]`))}console.log(`
=== SKILL SOURCE ANALYSIS ===`);const t={};if(s._provenance)for(const[e,o]of Object.entries(s._provenance)){const l="_set"in o&&o._set?o._set:o;if(l&&Array.isArray(l.skills))for(const n of l.skills)t[n]||(t[n]={}),t[n][e]=(t[n][e]||0)+1}for(const[e,o]of Object.entries(t)){const l=Object.values(o).reduce((i,r)=>i+r,0);console.log(`${e}:`);for(const[i,r]of Object.entries(o))console.log(`  ‚Üí ${i}: ${r} instance(s)`);const n=s.skills.filter(i=>i===e).length;console.log(`  üìä Expected: ${l}, Actual: ${n}`),console.log(n!==l?`  ‚ö†Ô∏è  MISMATCH: Expected ${l}, found ${n} in skills array`:"  ‚úÖ CORRECT: Instance count matches expectations")}const c={};for(const e of s.skills)c[e]=(c[e]||0)+1;console.log(`
=== DUPLICATE DETECTION ===`);for(const[e,o]of Object.entries(c))o>1&&console.log(`üî¥ DUPLICATE: ${e} appears ${o} times`);return{skills:s.skills,provenance:s._provenance,skillSources,duplicates:Object.entries(c).filter(([e,o])=>o>1)}}var x=S(`<div class="main-content svelte-1vcmimc"><h1>Race Page (Debug View)</h1> <p>This is just a test to see what's in <code>character_store</code>.</p> <button style="background: blue; color: white; padding: 10px; margin: 10px;">Debug Conflicts</button> <button style="background: green; color: white; padding: 10px; margin: 10px;">Test Bard+Elf Conflict</button> <pre> </pre></div>`);function M(s,t){_(t,!1);let c=$();const e=f.subscribe(a=>{A(c,a)});E(e);function o(){console.log("=== MANUAL DEBUG START ===");const a=B(),m=v();return console.log(`
=== CONFLICT DETECTION ===`),console.log("Conflicts:",m),a}P();var l=x(),n=d(u(l),4),i=d(n,2),r=d(i,2),h=u(r,!0);k(r),k(l),y(a=>I(h,a),[()=>JSON.stringify(T(c),null,2)]),b("click",n,o),b("click",i,()=>C()),O(s,l),j()}export{M as component};
