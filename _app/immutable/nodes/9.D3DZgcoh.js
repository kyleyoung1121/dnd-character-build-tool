import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{a as ca}from"../chunks/BzL6bSYp.js";import{p as la,aD as Le,aE as va,f as P,a as b,b as pa,g as e,s as g,m as T,aF as ve,c as _,d as l,r as c,t as D,a2 as r,aB as re,aG as ke}from"../chunks/reGDeH5k.js";import{s as $,e as W}from"../chunks/BqrWAL6L.js";import{i as Q}from"../chunks/BsBALOho.js";import{h as Oe,s as We,a as Ae,r as Ye,k as je,i as Ee,b as Ge}from"../chunks/CxMyCZnp.js";import{e as Y,i as pe}from"../chunks/CeIadcAq.js";import{s as ne}from"../chunks/BAKws97Y.js";import{i as da}from"../chunks/CQeXo9oH.js";import{g as de}from"../chunks/Ei9ertFE.js";import{b as Te}from"../chunks/CJrUabga.js";import{c as me}from"../chunks/BNvG-lJZ.js";const ma={name:"Draconic Ancestry",id:"dragonborn_draconic_ancestry",description:`
		You have a draconic ancestry. Choose one type of dragon from the table. 
		Your breath weapon and damage resistance are determined by the dragon type.
	`,featureOptions:{placeholderText:"-Choose a Dragon Type-",options:["Black (Acid)","Blue (Lightning)","Brass (Fire)","Bronze (Lightning)","Copper (Acid)","Gold (Fire)","Green (Poison)","Red (Fire)","Silver (Cold)","White (Cold)"],numPicks:1},source:"dragonborn",effects:[{target:"features",action:"add",value:"{userChoice} Ancestry"},{target:"resistances",action:"add",value:"{userChoice} Damage Resistance"}]},fa=[{name:"Breath Weapon",id:"dragonborn_breath_weapon",description:`
			You can use your action to exhale destructive energy. 
			Your draconic ancestry determines the size, shape, and damage type of the exhalation.
		`,source:"dragonborn",effects:[{target:"features",action:"add",value:"Breath Weapon"}]},{name:"Damage Resistance",id:"dragonborn_damage_resistance",description:`
			You have resistance to the damage type associated with your draconic ancestry.
		`,source:"dragonborn",effects:[{target:"features",action:"add",value:"Damage Resistance"}]}],ua={name:"Dragonborn",image:Te+"/race_icons/dragonborn.jpg",description:`
		Born of dragons, as their name proclaims, the dragonborn walk proudly through a world 
		that greets them with fearful incomprehension. Shaped by draconic gods or the dragons 
		themselves, dragonborn originally hatched from dragon eggs as a unique race, combining 
		the best attributes of dragons and humanoids.
	`,abilityScoreIncrease:"+2 Strength, +1 Charisma",speed:"30 ft.",size:"Medium",knownLanguages:["Common","Draconic"],raceFeatures:[ma,...fa]};var _a=P('<button class="race-card svelte-c6i00h"><div class="card-left svelte-c6i00h"><img class="svelte-c6i00h"/> <span> </span></div> <img class="card-arrow svelte-c6i00h" alt="next arrow"/></button>'),ha=P('<div class="race-cards svelte-c6i00h"></div>'),ga=P('<div class="feature-card svelte-c6i00h"><h4> </h4> <p><!></p></div>'),ya=P('<div class="popup svelte-c6i00h"><div class="popup-content svelte-c6i00h"><div class="popup-header svelte-c6i00h"><span>CONFIRM ADD RACE</span> <button class="close-button svelte-c6i00h">×</button></div> <div class="popup-body svelte-c6i00h"><h2> </h2> <p class="description svelte-c6i00h"> </p> <!></div> <div class="popup-footer svelte-c6i00h"><button class="cancel-button svelte-c6i00h">Cancel</button> <button class="add-button svelte-c6i00h">Add Race</button></div></div></div>'),ba=P("<option> </option>"),ka=P('<select class="svelte-c6i00h"><option disabled> </option><!></select>'),Oa=P("<option> </option>"),Aa=P('<select class="svelte-c6i00h"><option disabled> </option><!></select>'),Pa=P("<div><h4> </h4> <p><!></p> <!></div>"),Sa=P("<!> <!>",1),$a=P("<p><!></p> <!>",1),wa=P('<div><button class="feature-header svelte-c6i00h" type="button"><span class="feature-name svelte-c6i00h"> </span> <span class="expand-indicator svelte-c6i00h"> </span></button> <!></div>'),xa=P('<div class="selected-race-card svelte-c6i00h"><div class="selected-race-info svelte-c6i00h"><img class="selected-race-icon svelte-c6i00h"/> <div class="selected-race-text svelte-c6i00h"><h2 class="svelte-c6i00h"> </h2> <p class="description svelte-c6i00h"> </p></div> <button class="remove-race-button svelte-c6i00h" aria-label="Remove selected race">✕</button></div> <!></div>'),Ca=P(`<div class="main-content svelte-c6i00h"><p class="intro-text svelte-c6i00h">In Dungeons & Dragons, your character's race affects your abilities, traits, and what unique features you can access.
		Each race has strengths and weaknesses, so choose wisely!</p> <!> <!> <!></div>`);function qa(ze,Ve){la(Ve,!1);const oe=T(),qe=T(),Pe=[ua];let O=T(null),h=T(null),s=T({}),w=T(new Set),z=T(0);function U(){g(z,(e(z)+1)%1e6)}function Ke(a){e(w).has(a)?e(w).delete(a):e(w).add(a),g(w,new Set(e(w)))}function Se(a,n){const v=a.featureOptions?.options||[],t=e(s)[a.name]||[],p=t[n]??null,o=de(me),m=new Set;if(Array.isArray(o.skills))for(const d of o.skills)m.add(d);if(Array.isArray(o.languages))for(const d of o.languages)m.add(d);if(Array.isArray(o.proficiencies))for(const d of o.proficiencies)m.add(d);for(const[d,u]of Object.entries(e(s)))for(const[y,S]of(u||[]).entries())S&&(d===a.name&&y===n||m.add(S));return v.filter(d=>{const u=typeof d=="string"?d:d.name;return t.some((y,S)=>y===u&&S!==n)?!1:p===u?!0:!m.has(u)})}function $e(a,n){if(a.length<n){const v=a.length;a.length=n;for(let t=v;t<n;t++)a[t]=null}}function we(a,n,v){const t=a.featureOptions?.numPicks||1;e(s)[a.name]?$e(e(s)[a.name],t):ve(s,e(s)[a.name]=Array(t).fill(null));const p=e(s)[a.name][n],o=[...e(s)[a.name]];if(o[n]=v,g(s,{...e(s),[a.name]:o}),U(),p!==v){Me(a,e(s));const m=`feature:${a.name}:${n}`;p&&Ye(de(me),m);const d=a.effects||[],u={};for(const y of d){const S=y.value==="{userChoice}"?v:y.value;y.action==="add"?u[y.target]=Array.isArray(S)?S:[S]:y.action==="set"&&(u[y.target]=S)}Ae(m,u)}}function Me(a,n){if(!a.featureOptions)return;let v=!1;for(const t of a.featureOptions.options)if(typeof t!="string"&&t.nestedPrompts)for(const p of t.nestedPrompts)n[p.name]&&(delete n[p.name],v=!0);v&&(g(s,{...n}),U())}function He(a,n){if(!a.featureOptions)return[];const v=[];for(const t of a.featureOptions.options){const p=typeof t=="string"?t:t.name;n.includes(p)&&typeof t!="string"&&t.nestedPrompts&&v.push(...t.nestedPrompts)}return v}function Je(){if(e(h)){let v=function(o){const m=[];for(const d of o)if(m.push(d.name),d.featureOptions)for(const u of d.featureOptions.options)typeof u!="string"&&u.nestedPrompts&&m.push(...v(u.nestedPrompts));return m};const a=de(me),n=Object.keys(a._provenance||{}),t=v(e(h).raceFeatures||[]),p=[`race:${e(h).name}`,...t.map(o=>`feature:${o}`)];for(const o of n)p.some(m=>o.startsWith(m))&&Ye(a,o)}g(h,null),g(O,null),g(s,{}),g(w,new Set),U()}function Qe(){if(e(O)){g(h,e(O)),g(O,null),g(s,{}),g(w,new Set),Ae(`race:${e(h).name}`,{race:e(h).name});for(const a of e(h).raceFeatures||[])a.featureOptions||Ae(`feature:${a.name}`,{features:[a.name]});U()}}function ie(a,n){if(!a.featureOptions)return!1;const v=a.featureOptions.numPicks??1,t=n[a.name];if(!t||t.length<v||t.some(o=>!o))return!0;const p=t.filter(Boolean);for(const o of a.featureOptions.options)if(typeof o!="string"&&p.includes(o.name)&&o.nestedPrompts){for(const m of o.nestedPrompts)if(ie(m,n))return!0}return!1}ca(()=>{const a=de(me);if(a.race){const n=Pe.find(v=>v.name===a.race);if(n){g(h,n),g(s,{});for(const t of n.raceFeatures||[])a.features?.includes(t.name)&&ve(s,e(s)[t.name]=[]);const v=Object.keys(a._provenance||{});for(const t of v){if(!t.startsWith("feature:"))continue;const[,p,o]=t.split(":"),m=parseInt(o,10)||0,d=a._provenance?.[t];if(!d)continue;const u=n.raceFeatures?.find(y=>y.name===p)?.featureOptions?.numPicks||1;e(s)[p]?$e(e(s)[p],u):ve(s,e(s)[p]=Array(u).fill(null)),Array.isArray(d.features)&&d.features[0]&&ve(s,e(s)[p][m]=d.features[0])}g(s,{...e(s)}),U()}}}),Le(()=>e(h),()=>{g(oe,e(h)?[...e(h).raceFeatures||[]]:[])}),Le(()=>(e(oe),e(s)),()=>{g(qe,e(oe).map(a=>({feature:a,incomplete:ie(a,e(s))})))}),va(),da();var fe=Ca(),xe=_(l(fe),2);{var Ue=a=>{var n=ha();Y(n,5,()=>Pe,pe,(v,t)=>{var p=_a(),o=l(p),m=l(o),d=_(m,2),u=l(d,!0);c(d),c(o);var y=_(o,2);c(p),D(()=>{ne(m,"src",(e(t),r(()=>e(t).image))),ne(m,"alt",(e(t),r(()=>`${e(t).name} icon`))),$(u,(e(t),r(()=>e(t).name))),ne(y,"src",`${Te??""}/basic_icons/blue_next.png`)}),W("click",p,()=>g(O,e(t))),b(v,p)}),c(n),b(a,n)};Q(xe,a=>{e(h)||a(Ue)})}var Ce=_(xe,2);{var Xe=a=>{var n=ya(),v=l(n),t=l(v),p=_(l(t),2);c(t);var o=_(t,2),m=l(o),d=l(m,!0);c(m);var u=_(m,2),y=l(u,!0);c(u);var S=_(u,2);Y(S,1,()=>(e(O),r(()=>e(O).raceFeatures)),pe,(K,B)=>{var X=ga(),M=l(X),ue=l(M,!0);c(M);var ce=_(M,2),_e=l(ce);Oe(_e,()=>(e(B),r(()=>e(B).description))),c(ce),c(X),D(()=>$(ue,(e(B),r(()=>e(B).name)))),b(K,X)}),c(o);var V=_(o,2),i=l(V),q=_(i,2);c(V),c(v),c(n),D(()=>{$(d,(e(O),r(()=>e(O).name))),$(y,(e(O),r(()=>e(O).description)))}),W("click",p,()=>g(O,null)),W("click",i,()=>g(O,null)),W("click",q,Qe),b(a,n)};Q(Ce,a=>{e(O)&&a(Xe)})}var Ze=_(Ce,2);{var Fe=a=>{var n=xa(),v=l(n),t=l(v),p=_(t,2),o=l(p),m=l(o,!0);c(o);var d=_(o,2),u=l(d,!0);c(d),c(p);var y=_(p,2);c(v);var S=_(v,2);Y(S,1,()=>e(oe),V=>V.name,(V,i)=>{var q=wa(),K=l(q),B=l(K),X=l(B,!0);c(B);var M=_(B,2),ue=l(M,!0);c(M),c(K);var ce=_(K,2);{var _e=Z=>{var le=$a(),he=re(le),Ie=l(he);Oe(Ie,()=>(e(i),r(()=>e(i).description))),c(he);var ea=_(he,2);{var aa=ge=>{var De=Sa(),Re=re(De);Y(Re,1,()=>(e(i),r(()=>Array(e(i).featureOptions.numPicks))),pe,(F,f,x)=>{var H=ke(),ye=re(H);je(ye,()=>(e(i),e(z),r(()=>`${e(i).name}:${x}:${e(z)}`)),I=>{var C=ka(),j=l(C),be=l(j,!0);c(j),j.value=j.__value="";var E=_(j);Y(E,1,()=>(e(i),r(()=>Se(e(i),x))),R=>typeof R=="string"?R:R.name,(R,k)=>{var J=ba(),N=l(J,!0);c(J);var ae={};D(()=>{$(N,(e(k),r(()=>typeof e(k)=="string"?e(k):e(k).name))),ae!==(ae=(e(k),r(()=>typeof e(k)=="string"?e(k):e(k).name)))&&(J.value=(J.__value=(e(k),r(()=>typeof e(k)=="string"?e(k):e(k).name)))??"")}),b(R,J)}),c(C);var ee;Ee(C),D(()=>{$(be,(e(i),r(()=>e(i).featureOptions.placeholderText||"Select an option"))),ee!==(ee=(e(s),e(i),r(()=>e(s)[e(i).name]?.[x]||"")))&&(C.value=(C.__value=(e(s),e(i),r(()=>e(s)[e(i).name]?.[x]||"")))??"",Ge(C,(e(s),e(i),r(()=>e(s)[e(i).name]?.[x]||""))))}),W("change",C,R=>{const k=R.target;we(e(i),x,k.value)}),b(I,C)}),b(F,H)});var ta=_(Re,2);Y(ta,1,()=>(e(i),e(s),r(()=>He(e(i),e(s)[e(i).name]||[]))),F=>F.name,(F,f)=>{var x=Pa(),H=l(x),ye=l(H,!0);c(H);var I=_(H,2),C=l(I);Oe(C,()=>(e(f),r(()=>e(f).description))),c(I);var j=_(I,2);{var be=E=>{var ee=ke(),R=re(ee);Y(R,1,()=>(e(f),r(()=>Array(e(f).featureOptions.numPicks))),pe,(k,J,N)=>{var ae=ke(),sa=re(ae);je(sa,()=>(e(f),e(z),r(()=>`${e(f).name}:${N}:${e(z)}`)),ra=>{var L=Aa(),te=l(L),na=l(te,!0);c(te),te.value=te.__value="";var oa=_(te);Y(oa,1,()=>(e(f),r(()=>Se(e(f),N))),G=>typeof G=="string"?G:G.name,(G,A)=>{var se=Oa(),ia=l(se,!0);c(se);var Ne={};D(()=>{$(ia,(e(A),r(()=>typeof e(A)=="string"?e(A):e(A).name))),Ne!==(Ne=(e(A),r(()=>typeof e(A)=="string"?e(A):e(A).name)))&&(se.value=(se.__value=(e(A),r(()=>typeof e(A)=="string"?e(A):e(A).name)))??"")}),b(G,se)}),c(L);var Be;Ee(L),D(()=>{$(na,(e(f),r(()=>e(f).featureOptions.placeholderText||"Select an option"))),Be!==(Be=(e(s),e(f),r(()=>e(s)[e(f).name]?.[N]||"")))&&(L.value=(L.__value=(e(s),e(f),r(()=>e(s)[e(f).name]?.[N]||"")))??"",Ge(L,(e(s),e(f),r(()=>e(s)[e(f).name]?.[N]||""))))}),W("change",L,G=>{const A=G.target;we(e(f),N,A.value)}),b(ra,L)}),b(k,ae)}),b(E,ee)};Q(j,E=>{e(f),r(()=>e(f).featureOptions)&&E(be)})}c(x),D(E=>{We(x,1,`feature-card nested ${E??""}`,"svelte-c6i00h"),$(ye,(e(f),r(()=>e(f).name)))},[()=>(e(f),e(s),r(()=>ie(e(f),e(s))?"incomplete":e(f).featureOptions?"complete":""))]),b(F,x)}),b(ge,De)};Q(ea,ge=>{e(i),r(()=>e(i).featureOptions)&&ge(aa)})}b(Z,le)};Q(ce,Z=>{e(w),e(i),r(()=>e(w).has(e(i).name))&&Z(_e)})}c(q),D((Z,le)=>{We(q,1,`feature-card ${Z??""}`,"svelte-c6i00h"),$(X,(e(i),r(()=>e(i).name))),$(ue,le)},[()=>(e(i),e(s),r(()=>ie(e(i),e(s))?"incomplete":e(i).featureOptions?"complete":"")),()=>(e(w),e(i),r(()=>e(w).has(e(i).name)?"–":"+"))]),W("click",K,()=>Ke(e(i).name)),b(V,q)}),c(n),D(()=>{ne(t,"src",(e(h),r(()=>e(h).image))),ne(t,"alt",(e(h),r(()=>`${e(h).name} icon`))),$(m,(e(h),r(()=>e(h).name))),$(u,(e(h),r(()=>e(h).description)))}),W("click",y,Je),b(a,n)};Q(Ze,a=>{e(h)&&a(Fe)})}c(fe),b(ze,fe),pa()}export{qa as component};
