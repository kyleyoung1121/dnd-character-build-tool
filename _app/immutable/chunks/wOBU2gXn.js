import{g as d}from"./BiH1rH3r.js";import{c as g}from"./DANXc4Na.js";function C(){const e=d(g),i=[];if(!e._provenance)return{hasConflicts:!1,conflicts:[],tabsNeedingAttention:[]};const t={skill:{},proficiency:{},language:{},feature:{}};for(const[r,n]of Object.entries(e._provenance)){const c="_set"in n&&n._set?n._set:n;if(c)for(const[l,u]of Object.entries(c)){if(!Array.isArray(u))continue;let s;switch(l){case"skills":s="skill";break;case"proficiencies":s="proficiency";break;case"languages":s="language";break;case"features":s="feature";break;default:continue}for(const o of u)t[s][o]||(t[s][o]=[]),t[s][o].push(r)}}for(const[r,n]of Object.entries(t))for(const[c,l]of Object.entries(n))if(l.length>1){const u=m(l);i.push({type:r,value:c,sources:l,affectedTabs:u})}const a=[...new Set(i.flatMap(r=>r.affectedTabs||[]))];return{hasConflicts:i.length>0,conflicts:i,tabsNeedingAttention:a}}function m(e){const i=new Set,t=new Set;for(const n of e)n.startsWith("background:")||n.includes("background")||f(n)?(i.add("background"),S(n)&&t.add("background")):n.startsWith("race:")||y(n)?(i.add("species"),b(n)&&t.add("species")):(n.startsWith("class:")||n.startsWith("feature:")&&k(n))&&(i.add("class"),h(n)&&t.add("class"));const a=Array.from(i),r=Array.from(t);return[...r,...a.filter(n=>!r.includes(n))]}function h(e){return/:\d+$/.test(e)&&(e.includes("Skill Proficiencies")||e.includes("Bonus Proficiencies")||e.includes("Expertise")||e.includes("college_of_lore"))}function b(e){return/:\d+$/.test(e)&&(e.includes("Tool Proficiency")||e.includes("Cantrip")||e.includes("Draconic Ancestry"))}function k(e){return f(e)?!1:e.includes("Skill Proficiencies")||e.includes("Skills")||e.includes("Bonus Proficiencies")||e.includes("Expertise")||e.includes("college_of_lore")}function y(e){return e.includes("Keen Senses")||e.includes("Fey Ancestry")||e.includes("Trance")||e.includes("Darkvision")||e.includes("Dwarven")||e.includes("Elven")||e.includes("Halfling")||e.includes("Draconic")||e.includes("Tool Proficiency")}function f(e){if(e.startsWith("background:"))return!0;if(e.startsWith("feature:")){const i=d(g);if(!i.background||!(i._provenance&&Object.keys(i._provenance).some(n=>n.startsWith("background:"))))return!1;const a=e.split(":")[1];return a==="Skill Proficiencies"?(Object.keys(i._provenance||{}).filter(n=>n.includes("Skill")||n.includes("skill")),e==="feature:Skill Proficiencies"):["Tool Proficiencies","Equipment","Languages","Criminal Contact","Shelter of the Faithful","False Identity","By Popular Demand","Rustic Hospitality","Position of Privilege"].includes(a)}return e.includes("Acolyte")||e.includes("Charlatan")||e.includes("Criminal")||e.includes("Entertainer")||e.includes("Folk Hero")||e.includes("Gladiator")||e.includes("Guild Artisan")||e.includes("Hermit")||e.includes("Knight")||e.includes("Noble")||e.includes("Outlander")||e.includes("Pirate")||e.includes("Sage")||e.includes("Sailor")||e.includes("Soldier")||e.includes("Urchin")}function S(e){return!f(e)||e.startsWith("background:")?!1:e.startsWith("feature:")?!!/:\d+$/.test(e):/:\d+$/.test(e)}function F(e){const i=e.sources.filter(t=>h(t)||b(t)||S(t));if(i.length===0)return null;for(const t of i){if(t.startsWith("class:")||k(t))return"class";if(t.startsWith("race:")||t.startsWith("species:")||y(t))return"species";if(t.startsWith("background:")||f(t))return"background"}return null}export{C as d,F as g};
