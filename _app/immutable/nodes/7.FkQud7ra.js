import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{x as nt,af as $e,ag as rt,y as p,z as l,A as lt,a as e,s as ce,ah as de,ai as ye,B as f,C as a,u as s,E as o,aj as j,al as ke,am as _e,an as Ae}from"../chunks/Bdjag3zs.js";import{g as vt,s as b,e as pe}from"../chunks/BVPYibDR.js";import{i as D,s as ct,a as pt}from"../chunks/vJ5Czfxm.js";import{e as A,i as R}from"../chunks/So6lF2Dq.js";import{s as me}from"../chunks/C6ClwP9-.js";import{s as Pe}from"../chunks/BOqnH6kl.js";import{i as Re,s as Fe}from"../chunks/B-vw13G3.js";import{i as ut}from"../chunks/BbSQGgxI.js";import{c as Ge}from"../chunks/BMQPE_bs.js";import{a as ge}from"../chunks/bWUy9njV.js";import{b as Je}from"../chunks/B9s7Ajdv.js";import{g as dt,w as _t,s as mt,e as gt,r as ft,p as ht,m as jt,d as qt,c as bt,a as St,b as yt,f as kt}from"../chunks/CHSRHQlP.js";import{b as We}from"../chunks/D-5g4WkG.js";var Et=p('<div class="no-selection svelte-jontoi"><h2 class="svelte-jontoi">No Class Selected</h2> <p class="svelte-jontoi">Please select a class first to see starting equipment options.</p> <a class="nav-link svelte-jontoi">Go to Class Selection</a></div>'),Ct=p('<div class="no-equipment svelte-jontoi"><h2 class="svelte-jontoi">Equipment Not Available</h2> <p class="svelte-jontoi"> </p></div>'),Ot=p('<div class="equipment-item class-equipment svelte-jontoi"><span class="item-name svelte-jontoi"> </span> <span class="item-type svelte-jontoi">Auto-added</span></div>'),wt=p('<div class="equipment-group svelte-jontoi"><h3 class="svelte-jontoi">Standard Equipment</h3> <p class="fixed-equipment-note svelte-jontoi">This equipment is automatically added when you select your class.</p> <div class="equipment-list svelte-jontoi"></div></div>'),Bt=p("<button> </button>"),Nt=p("<option> </option>"),$t=p('<div class="weapon-selection"><select class="subchoice-select svelte-jontoi"><option> </option><!></select></div>'),At=p("<option> </option>"),Rt=p('<div class="simple-selection"><select class="subchoice-select svelte-jontoi"><option> </option><!></select></div>'),Ft=p('<div class="subchoice-group svelte-jontoi"><h4 class="svelte-jontoi"> </h4> <p class="subchoice-description svelte-jontoi"> </p> <!></div>'),Tt=p('<div class="subchoices-container svelte-jontoi"></div>'),zt=p('<div class="enhanced-choice svelte-jontoi"><div class="main-options svelte-jontoi"></div> <!></div>'),Dt=p("<option> </option>"),Lt=p('<div class="dropdown-container svelte-jontoi"><select class="equipment-dropdown svelte-jontoi"><option disabled>Choose an option...</option><!></select></div>'),Mt=p('<span class="option-item svelte-jontoi"> </span>'),Pt=p('<button class="choice-option svelte-jontoi"><div class="option-items svelte-jontoi"></div></button>'),Gt=p('<div class="choice-options svelte-jontoi"></div>'),Jt=p('<div class="equipment-group svelte-jontoi"><h3 class="svelte-jontoi"> </h3> <p class="choice-description svelte-jontoi"> </p> <!></div>'),Wt=p('<div class="equipment-section svelte-jontoi"><div class="section-header svelte-jontoi"><img class="class-icon svelte-jontoi"/> <h2 class="svelte-jontoi"> </h2></div> <!> <!></div>'),Ut=p('<div class="equipment-item background svelte-jontoi"><span class="item-name svelte-jontoi"> </span> <span class="item-type svelte-jontoi">Auto-added</span></div>'),Ht=p('<div class="equipment-group svelte-jontoi"><h3 class="svelte-jontoi">Fixed Equipment</h3> <p class="background-note svelte-jontoi">This equipment is automatically added when you select your background.</p> <div class="equipment-list svelte-jontoi"></div></div>'),Kt=p("<option> </option>"),Qt=p('<div class="dropdown-container svelte-jontoi"><select class="equipment-dropdown svelte-jontoi"><option disabled>Choose an option...</option><!></select></div>'),Vt=p('<span class="option-item svelte-jontoi"> </span>'),Xt=p('<button><div class="option-items svelte-jontoi"></div></button>'),Yt=p('<div class="choice-options svelte-jontoi"></div>'),Zt=p('<div class="equipment-group svelte-jontoi"><h3 class="svelte-jontoi"> </h3> <p class="choice-description svelte-jontoi"> </p> <!></div>'),xt=p("<!> <!>",1),It=p('<div class="equipment-item background svelte-jontoi"><span class="item-name svelte-jontoi"> </span> <span class="item-type svelte-jontoi">From Background</span></div>'),eo=p('<div class="equipment-group svelte-jontoi"><h3 class="svelte-jontoi">Background Equipment</h3> <p class="background-note svelte-jontoi">This equipment is automatically added when you select your background.</p> <div class="equipment-list svelte-jontoi"></div></div>'),to=p('<div class="equipment-section svelte-jontoi"><div class="section-header svelte-jontoi"><img class="background-icon svelte-jontoi"/> <h2 class="svelte-jontoi"> </h2></div> <!></div>'),oo=p('<div class="equipment-section svelte-jontoi"><h2>Background Equipment</h2> <p>Background equipment data is loading...</p></div>'),so=p('<div class="no-selection svelte-jontoi"><h2 class="svelte-jontoi">No Background Selected</h2> <p class="svelte-jontoi">Select a background to see additional starting equipment.</p> <a class="nav-link svelte-jontoi">Go to Background Selection</a></div>'),ao=p(`<div class="main-content svelte-jontoi"><div class="intro-text svelte-jontoi"><h1 class="svelte-jontoi">Equipment</h1> <p class="svelte-jontoi">Select your starting equipment based on your class and background. Equipment choices will
			automatically update your character sheet.</p></div> <!> <!></div>`);function bo(Ue,He){nt(He,!1);const[Ke,Qe]=ct(),Q=()=>pt(Ge,"$character_store",Ke),Ve={Fighter:kt,Barbarian:yt,Bard:St,Cleric:bt,Druid:qt,Monk:jt,Paladin:ht,Ranger:ft,Rogue:gt,Sorcerer:mt,Warlock:_t,Wizard:dt};let m=de(null),S=de(null),g=de({}),I=de({}),ie=de({}),ne=de({});function Xe(){if(!e(m)?.startingEquipment?.choices){console.log("‚ùå No class or equipment choices to restore");return}const t=vt(Ge);if(!t._provenance){console.log("‚ùå No provenance data found");return}console.log("üîç Checking provenance for equipment choices:",t._provenance);const n={};e(m).startingEquipment.choices.forEach((d,u)=>{const h=`class_equipment_${u}`,r=t._provenance[h];if(console.log(`üîç Checking choice ${u} (${h}):`,r),r&&(console.log("üîç Provenance data keys:",JSON.stringify(Object.keys(r))),console.log("üîç selectedOption:",r.selectedOption),console.log("üîç subChoiceSelections:",r.subChoiceSelections),console.log("üîç inventory:",r.inventory),console.log("üîç _set:",r._set),console.log("üîç _prevScalars:",r._prevScalars),console.log("üîç Full object:",JSON.stringify(r,null,2))),console.log("üîç Choice structure:",d),console.log("üîç isEquipmentChoice result:",Ee(d)),r)if(console.log("üö® Attempting restore regardless of type (debug mode)"),Ee(d)){const c=r._set||r;if(console.log("üîç Actual data to restore:",c),c.selectedOption!==void 0)console.log(`‚úÖ Restoring new format for choice ${u}:`,c.selectedOption,c.subChoiceSelections),n[u]={selectedOption:c.selectedOption,subChoiceSelections:c.subChoiceSelections||{}};else if(c.inventory){console.log(`üîÑ Using legacy format for choice ${u}:`,c.inventory);const C=c.inventory;for(let E=0;E<d.options.length;E++){const L=d.options[E];if(Ye(L,C)){n[u]={selectedOption:E,subChoiceSelections:Ze(L,C)};break}}}}else console.log(`‚ùå isEquipmentChoice failed for choice ${u}`);else console.log(`‚ùå No provenance data for choice ${u}`)}),Object.keys(n).length>0?(console.log("‚úÖ Restoring equipment choices:",n),ce(g,{...e(g),...n})):console.log("‚ùå No equipment choices found to restore")}function Ye(t,n){const d=[];if(t.items&&d.push(...t.items),t.subChoices)for(const u of t.subChoices)d.push(...u.options);return n.every(u=>d.includes(u))}function Ze(t,n){const d={};if(!t.subChoices)return d;for(const u of t.subChoices){const h=n.filter(r=>u.options.includes(r));h.length>0&&(d[u.name]=h)}return d}function Ee(t){return"options"in t&&t.options.length>0&&typeof t.options[0]=="object"&&"label"in t.options[0]}function xe(t){return"options"in t&&t.options.length>0&&Array.isArray(t.options[0])}function Te(t,n){if(!e(m))return;const u=e(m).startingEquipment.choices[t].options[n],h=`class_equipment_${t}`;ge(h,{inventory:u})}function Ie(t,n){if(!e(m))return;const u=e(m).startingEquipment.choices[t].options[n],h=`class_equipment_${t}`;ge(h,{inventory:[]});const r={...e(g)};r[t]={selectedOption:n,subChoiceSelections:{}},ce(g,r);const c={selectedOption:n,subChoiceSelections:{},inventory:[]};console.log(`üíæ Storing main selection for choice ${t}:`,c),ge(h,c),u.items&&!u.subChoices&&(c.inventory=u.items,ge(h,c))}function ze(t,n,d){if(!e(m)||!e(g)[t])return;const u=e(m).startingEquipment.choices[t],h=e(g)[t].selectedOption;if(h===void 0)return;const r=u.options[h],c={...e(g)};c[t]={...e(g)[t],subChoiceSelections:{...e(g)[t].subChoiceSelections,[n]:d}},ce(g,c);const C=`class_equipment_${t}`,E={selectedOption:h,subChoiceSelections:c[t].subChoiceSelections,inventory:[]};if(r.subChoices?.every(F=>c[t].subChoiceSelections[F.name]?.length>0)??!0){let F=[];if(r.items&&F.push(...r.items),r.subChoices&&c[t].subChoiceSelections)for(const V of r.subChoices){const oe=c[t].subChoiceSelections[V.name];oe&&F.push(...oe)}E.inventory=F}console.log(`üíæ Storing subchoice selection for choice ${t}:`,E),ge(C,E)}function De(t,n){if(!e(S)?.startingEquipment)return;ye(I,e(I)[t]=n);const u=e(S).startingEquipment.choices[t].options[n],h=`background_equipment_${t}`;ge(h,{inventory:u})}$e(()=>(Q(),e(m)),()=>{const t=Q().class;ce(m,t?Ve[t]:null),e(m)&&(console.log("üîÑ Class changed, attempting to restore equipment choices for:",t),Xe())}),$e(()=>(Q(),We),()=>{const t=Q().background;ce(S,t&&We.find(n=>n.name===t)||null)}),$e(()=>(e(m),e(g)),()=>{e(m)?.startingEquipment?.choices&&(ce(ie,{}),ce(ne,{}),e(m).startingEquipment.choices.forEach((t,n)=>{if(Ee(t)&&e(g)[n]?.selectedOption!==void 0){const d=t.options[e(g)[n].selectedOption];ye(ie,e(ie)[n]=!!(d.subChoices&&d.subChoices.length>0)),ye(ne,e(ne)[n]=d.subChoices||[])}else ye(ie,e(ie)[n]=!1),ye(ne,e(ne)[n]=[])}))}),rt(),ut();var Oe=ao(),Le=f(a(Oe),2);{var et=t=>{var n=Et(),d=f(a(n),4);o(n),j(()=>me(d,"href",`${Je??""}/class`)),l(t,n)},tt=t=>{var n=ke(),d=_e(n);{var u=r=>{var c=Ct(),C=f(a(c),2),E=a(C);o(C),o(c),j(()=>b(E,`Starting equipment data is not yet available for ${Q(),s(()=>Q().class)??""}. This will be
				added soon!`)),l(r,c)},h=r=>{var c=Wt(),C=a(c),E=a(C),L=f(E,2),F=a(L);o(L),o(C);var V=f(C,2);{var oe=O=>{var v=wt(),_=f(a(v),4);A(_,5,()=>(e(m),s(()=>e(m).startingEquipment.fixed)),R,(W,U)=>{var H=Ot(),M=a(H),re=a(M,!0);o(M),Ae(2),o(H),j(()=>b(re,e(U))),l(W,H)}),o(_),o(v),l(O,v)};D(V,O=>{e(m),s(()=>e(m).startingEquipment.fixed.length>0)&&O(oe)})}var fe=f(V,2);A(fe,1,()=>(e(m),s(()=>e(m).startingEquipment.choices)),R,(O,v,_)=>{var W=Jt(),U=a(W),H=a(U,!0);o(U);var M=f(U,2),re=a(M,!0);o(M);var we=f(M,2);{var Be=P=>{var T=zt(),w=a(T);A(w,5,()=>(e(v),s(()=>e(v).options)),R,(k,B,N)=>{var i=Bt();let q;var y=a(i,!0);o(i),j($=>{q=Pe(i,1,"choice-option svelte-jontoi",null,q,$),b(y,(e(B),s(()=>e(B).label)))},[()=>({selected:e(g)[_]?.selectedOption===N})]),pe("click",i,()=>Ie(_,N)),l(k,i)}),o(w);var ee=f(w,2);{var X=k=>{var B=Tt();A(B,5,()=>(e(ne),s(()=>e(ne)[_])),R,(N,i)=>{var q=Ft(),y=a(q),$=a(y,!0);o(y);var te=f(y,2),he=a(te,!0);o(te);var Y=f(te,2);{var Z=z=>{var J=$t(),G=a(J),le=a(G),qe=a(le);o(le),le.value=le.__value="";var be=f(le);A(be,1,()=>(e(i),s(()=>e(i).options)),R,(K,se)=>{var ve=Nt(),Ce=a(ve,!0);o(ve);var ae={};j(()=>{b(Ce,e(se)),ae!==(ae=e(se))&&(ve.value=(ve.__value=e(se))??"")}),l(K,ve)}),o(G);var x;Re(G),o(J),j(K=>{b(qe,`Choose ${K??""}...`),x!==(x=(e(g),e(i),s(()=>e(g)[_]?.subChoiceSelections?.[e(i).name]?.[0]||"")))&&(G.value=(G.__value=(e(g),e(i),s(()=>e(g)[_]?.subChoiceSelections?.[e(i).name]?.[0]||"")))??"",Fe(G,(e(g),e(i),s(()=>e(g)[_]?.subChoiceSelections?.[e(i).name]?.[0]||""))))},[()=>(e(i),s(()=>e(i).name.toLowerCase()))]),pe("change",G,K=>{const se=K.target;se.value&&ze(_,e(i).name,[se.value])}),l(z,J)},je=z=>{var J=ke(),G=_e(J);{var le=qe=>{var be=Rt(),x=a(be),K=a(x),se=a(K);o(K),K.value=K.__value="";var ve=f(K);A(ve,1,()=>(e(i),s(()=>e(i).options)),R,(ae,ue)=>{var Se=At(),it=a(Se,!0);o(Se);var Me={};j(()=>{b(it,e(ue)),Me!==(Me=e(ue))&&(Se.value=(Se.__value=e(ue))??"")}),l(ae,Se)}),o(x);var Ce;Re(x),o(be),j(ae=>{b(se,`Choose ${ae??""}...`),Ce!==(Ce=(e(g),e(i),s(()=>e(g)[_]?.subChoiceSelections?.[e(i).name]?.[0]||"")))&&(x.value=(x.__value=(e(g),e(i),s(()=>e(g)[_]?.subChoiceSelections?.[e(i).name]?.[0]||"")))??"",Fe(x,(e(g),e(i),s(()=>e(g)[_]?.subChoiceSelections?.[e(i).name]?.[0]||""))))},[()=>(e(i),s(()=>e(i).name.toLowerCase()))]),pe("change",x,ae=>{const ue=ae.target;ue.value&&ze(_,e(i).name,[ue.value])}),l(qe,be)};D(G,qe=>{e(i),s(()=>e(i).type==="simple-list")&&qe(le)},!0)}l(z,J)};D(Y,z=>{e(i),s(()=>e(i).type==="weapon-list")?z(Z):z(je,!1)})}o(q),j(()=>{b($,(e(i),s(()=>e(i).name))),b(he,(e(i),s(()=>e(i).description)))}),l(N,q)}),o(B),l(k,B)};D(ee,k=>{e(ie),s(()=>e(ie)[_])&&k(X)})}o(T),l(P,T)},Ne=P=>{var T=ke(),w=_e(T);{var ee=X=>{var k=ke(),B=_e(k);{var N=q=>{var y=Lt(),$=a(y),te=a($);te.value=te.__value="";var he=f(te);A(he,1,()=>(e(v),s(()=>e(v).options)),R,(Y,Z,je)=>{var z=Dt(),J=a(z,!0);o(z),z.value=z.__value=je,j(G=>b(J,G),[()=>(e(Z),s(()=>e(Z).join(", ")))]),l(Y,z)}),o($),$.value=$.__value="",o(y),pe("change",$,Y=>{const Z=Y.target;Z.value&&Te(_,parseInt(Z.value))}),l(q,y)},i=q=>{var y=Gt();A(y,5,()=>(e(v),s(()=>e(v).options)),R,($,te,he)=>{var Y=Pt(),Z=a(Y);A(Z,5,()=>e(te),R,(je,z)=>{var J=Mt(),G=a(J,!0);o(J),j(()=>b(G,e(z))),l(je,J)}),o(Z),o(Y),pe("click",Y,()=>Te(_,he)),l($,Y)}),o(y),l(q,y)};D(B,q=>{e(v),s(()=>e(v).options.length>3)?q(N):q(i,!1)})}l(X,k)};D(w,X=>{e(v),s(()=>xe(e(v)))&&X(ee)},!0)}l(P,T)};D(we,P=>{e(v),s(()=>Ee(e(v)))?P(Be):P(Ne,!1)})}o(W),j(()=>{b(H,(e(v),s(()=>e(v).name))),b(re,(e(v),s(()=>e(v).description)))}),l(O,W)}),o(c),j(()=>{me(E,"src",(e(m),s(()=>e(m).image))),me(E,"alt",(e(m),s(()=>e(m).name))),b(F,`${e(m),s(()=>e(m).name)??""} Starting Equipment`)}),l(r,c)};D(d,r=>{e(m),s(()=>!e(m)?.startingEquipment)?r(u):r(h,!1)},!0)}l(t,n)};D(Le,t=>{Q(),s(()=>!Q().class)?t(et):t(tt,!1)})}var ot=f(Le,2);{var st=t=>{var n=to(),d=a(n),u=a(d),h=f(u,2),r=a(h);o(h),o(d);var c=f(d,2);{var C=L=>{var F=xt(),V=_e(F);{var oe=O=>{var v=Ht(),_=f(a(v),4);A(_,5,()=>(e(S),s(()=>e(S).startingEquipment.fixed)),R,(W,U)=>{var H=Ut(),M=a(H),re=a(M,!0);o(M),Ae(2),o(H),j(()=>b(re,e(U))),l(W,H)}),o(_),o(v),l(O,v)};D(V,O=>{e(S),s(()=>e(S).startingEquipment.fixed.length>0)&&O(oe)})}var fe=f(V,2);A(fe,1,()=>(e(S),s(()=>e(S).startingEquipment.choices)),R,(O,v,_)=>{var W=Zt(),U=a(W),H=a(U,!0);o(U);var M=f(U,2),re=a(M,!0);o(M);var we=f(M,2);{var Be=P=>{var T=Qt(),w=a(T),ee=a(w);ee.value=ee.__value="";var X=f(ee);A(X,1,()=>(e(v),s(()=>e(v).options)),R,(B,N,i)=>{var q=Kt(),y=a(q,!0);o(q),q.value=q.__value=i,j($=>b(y,$),[()=>(e(N),s(()=>e(N).join(", ")))]),l(B,q)}),o(w);var k;Re(w),o(T),j(()=>{k!==(k=(e(I),s(()=>e(I)[_]??"")))&&(w.value=(w.__value=(e(I),s(()=>e(I)[_]??"")))??"",Fe(w,(e(I),s(()=>e(I)[_]??""))))}),pe("change",w,B=>{const N=B.target;N.value&&De(_,parseInt(N.value))}),l(P,T)},Ne=P=>{var T=Yt();A(T,5,()=>(e(v),s(()=>e(v).options)),R,(w,ee,X)=>{var k=Xt();let B;var N=a(k);A(N,5,()=>e(ee),R,(i,q)=>{var y=Vt(),$=a(y,!0);o(y),j(()=>b($,e(q))),l(i,y)}),o(N),o(k),j(i=>B=Pe(k,1,"choice-option svelte-jontoi",null,B,i),[()=>({selected:e(I)[_]===X})]),pe("click",k,()=>De(_,X)),l(w,k)}),o(T),l(P,T)};D(we,P=>{e(v),s(()=>e(v).options.length>3)?P(Be):P(Ne,!1)})}o(W),j(()=>{b(H,(e(v),s(()=>e(v).name))),b(re,(e(v),s(()=>e(v).description)))}),l(O,W)}),l(L,F)},E=L=>{var F=eo(),V=f(a(F),4);A(V,5,()=>(e(S),s(()=>e(S).equipment)),R,(oe,fe)=>{var O=It(),v=a(O),_=a(v,!0);o(v),Ae(2),o(O),j(()=>b(_,e(fe))),l(oe,O)}),o(V),o(F),l(L,F)};D(c,L=>{e(S),s(()=>e(S).startingEquipment)?L(C):L(E,!1)})}o(n),j(()=>{me(u,"src",(e(S),s(()=>e(S).image))),me(u,"alt",(e(S),s(()=>e(S).name))),b(r,`${e(S),s(()=>e(S).name)??""} Equipment`)}),l(t,n)},at=t=>{var n=ke(),d=_e(n);{var u=r=>{var c=oo();l(r,c)},h=r=>{var c=so(),C=f(a(c),4);o(c),j(()=>me(C,"href",`${Je??""}/background`)),l(r,c)};D(d,r=>{Q(),s(()=>Q().background)?r(u):r(h,!1)},!0)}l(t,n)};D(ot,t=>{e(S)?t(st):t(at,!1)})}o(Oe),l(Ue,Oe),lt(),Qe()}export{bo as component};
