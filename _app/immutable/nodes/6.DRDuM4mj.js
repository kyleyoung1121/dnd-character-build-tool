import"../chunks/DsnmJJEf.js";import"../chunks/CQMj6I71.js";import{o as ue}from"../chunks/CWh0W3WP.js";import{y as fe,ah as T,ai as ge,z as P,A as N,B as we,d as e,E as v,j as d,aj as F,ak as U,C as u,F as l,al as j,v as _,am as _e}from"../chunks/D8epjS11.js";import{g as K,s as A,e as V}from"../chunks/BiH1rH3r.js";import{i as W}from"../chunks/DNOeg3kL.js";import{e as X,i as Y}from"../chunks/Cf40ah7q.js";import{C as be,h as he}from"../chunks/B9K-xhhX.js";import{s as M}from"../chunks/Dmswp-gS.js";import{i as ye}from"../chunks/nRLFwT7N.js";import{b as ke}from"../chunks/BPjcew-M.js";import{i as xe,F as Fe}from"../chunks/C5adfhwt.js";import{b as Ae,a as Ce,c as $e,d as Se,f as Oe,m as Ne,p as Pe,r as Ve,e as Me,s as De,w as Ee,g as Le}from"../chunks/CZTUd0m-.js";import{a as Z,r as ee}from"../chunks/CFTOOR2V.js";import{c as R}from"../chunks/DANXc4Na.js";var je=P('<button class="class-card svelte-wt0gmw"><div class="card-left svelte-wt0gmw"><img class="svelte-wt0gmw"/> <span> </span></div> <img class="card-arrow svelte-wt0gmw" alt="next arrow"/></button>'),Re=P('<div class="class-cards svelte-wt0gmw"></div>'),ze=P('<div class="feature-card svelte-wt0gmw"><h4> </h4> <p><!></p></div>'),Be=P('<div class="popup svelte-wt0gmw"><div class="popup-content svelte-wt0gmw"><div class="popup-header svelte-wt0gmw"><span>CONFIRM ADD CLASS</span> <button class="close-button svelte-wt0gmw">×</button></div> <div class="popup-body svelte-wt0gmw"><h2> </h2> <p class="description svelte-wt0gmw"> </p> <p><strong>Primary Ability:</strong> </p> <!></div> <div class="popup-footer svelte-wt0gmw"><button class="cancel-button svelte-wt0gmw">Cancel</button> <button class="add-button svelte-wt0gmw">Add Class</button></div></div></div>'),He=P('<div class="selected-class-card svelte-wt0gmw"><div class="selected-class-info svelte-wt0gmw"><img class="selected-class-icon svelte-wt0gmw"/> <div class="selected-class-text svelte-wt0gmw"><h2 class="svelte-wt0gmw"> </h2> <p class="max-hp svelte-wt0gmw"> </p></div> <button class="remove-class-button svelte-wt0gmw" aria-label="Remove selected class">✕</button></div> <!></div>'),Ke=P(`<div class="main-content svelte-wt0gmw"><!> <p class="intro-text svelte-wt0gmw">In Dungeons & Dragons, your character's class determines what they can do. It marks what role
		your character will play in your party of adventurers. Each class has strengths and weaknesses,
		so its important to use teamwork!</p> <!> <!> <!></div>`);function rt(te,se){fe(se,!1);const D=F(),ae=F(),q=[Ae,Ce,$e,Se,Oe,Ne,Pe,Ve,Me,De,Ee,Le];let w=F(null),i=F(null),f=F({}),E=F(new Set),L=F(0);function z(){d(L,(e(L)+1)%1e6)}function re(){if(e(i)){let n=function(t){const o=[];for(const m of t)if(o.push(m.name),m.featureOptions)for(const g of m.featureOptions.options)typeof g!="string"&&g.nestedPrompts&&o.push(...n(g.nestedPrompts));return o};const s=K(R),r=Object.keys(s._provenance||{}),a=n(e(i).classFeatures||[]),p=[`class:${e(i).name}`,...a.map(t=>`feature:${t}`)];for(const t of r)p.some(o=>t.startsWith(o))&&ee(s,t)}d(i,null),d(w,null),d(f,{}),d(E,new Set),z()}function oe(){if(e(w)){d(i,e(w)),d(w,null),d(f,{}),d(E,new Set),Z(`class:${e(i).name}`,{class:e(i).name});for(const s of e(i).classFeatures||[]){if(s.featureOptions)continue;const r=`feature:${s.name}`;ee(K(R),r);const n={},a={};for(const p of s.effects||[]){const t=p.target,o=p.value;switch(p.action){case"add":{const m=Array.isArray(o)?o:[o];n[t]||(n[t]=[]),n[t].push(...m);break}case"set":{n[t]=o;break}case"modify":{const m=Number(o);isNaN(m)||(a[t]=(a[t]??0)+m);break}}}Z(r,n,a)}z()}}function ne(s){if(!s)return"N/A";const r=s.match(/d(\d+)/);if(!r)return"N/A";const n=parseInt(r[1],10),a=Math.floor(n/2)+1;return n+a*2}function ce(s,r){if(s.length<r){const n=s.length;s.length=r;for(let a=n;a<r;a++)s[a]=null}}ue(()=>{const s=K(R);if(!s.class)return;const r=q.find(t=>t.name===s.class);if(!r)return;d(i,r),d(f,{});const n=t=>t.toLowerCase().replace(/\s+/g,"_"),a=(t,o)=>{const m=n(t);for(const[g,k]of o.entries())if(m.includes(g))return k;return null},p=t=>{const o=t.featureOptions?.numPicks||1;e(f)[t.name]?ce(e(f)[t.name],o):U(f,e(f)[t.name]=Array(o).fill(null));const m=t.featureOptions?.options||[],g=new Map(m.map(c=>[n(typeof c=="string"?c:c.name),typeof c=="string"?c:c.name])),k=s._provenance||{};for(let c=0;c<o;c++){if(e(f)[t.name][c])continue;const b=`feature:${t.name}:${c}`,h=k[b];let y=null;if(h?._set)for(const C of t.effects||[]){const $=C.target,S=h._set[$];if(Array.isArray(S))for(const x of S){const O=a(x,g);if(O){y=O;break}}else if(typeof S=="string"){const x=a(S,g);x&&(y=x)}if(y)break}if(!y&&h?._mods)for(const C of Object.keys(h._mods)){const $=a(C,g);if($){y=$;break}}y&&U(f,e(f)[t.name][c]=y)}t.featureOptions?.options&&t.featureOptions.options.forEach(c=>{typeof c!="string"&&c.nestedPrompts&&e(f)[t.name].find(h=>h===c.name)&&c.nestedPrompts.forEach(h=>p(h))})};r.classFeatures?.forEach(t=>p(t)),d(f,{...e(f)}),z()}),T(()=>e(i),()=>{d(D,e(i)?[...e(i).classFeatures||[]]:[])}),T(()=>(e(D),e(f)),()=>{d(ae,e(D).map(s=>({feature:s,incomplete:xe(s,e(f))})))}),ge(),ye();var B=Ke(),G=v(B);be(G,{tabName:"class"});var I=u(G,4);{var ie=s=>{var r=Re();X(r,5,()=>q,Y,(n,a)=>{var p=je(),t=v(p),o=v(t),m=u(o,2),g=v(m,!0);l(m),l(t);var k=u(t,2);l(p),j(()=>{M(o,"src",(e(a),_(()=>e(a).image))),M(o,"alt",(e(a),_(()=>`${e(a).name} icon`))),A(g,(e(a),_(()=>e(a).name))),M(k,"src",`${ke??""}/basic_icons/blue_next.png`)}),V("click",p,()=>d(w,e(a))),N(n,p)}),l(r),N(s,r)};W(I,s=>{e(i)||s(ie)})}var J=u(I,2);{var le=s=>{var r=Be(),n=v(r),a=v(n),p=u(v(a),2);l(a);var t=u(a,2),o=v(t),m=v(o,!0);l(o);var g=u(o,2),k=v(g,!0);l(g);var c=u(g,2),b=u(v(c));l(c);var h=u(c,2);X(h,1,()=>(e(w),_(()=>e(w).classFeatures)),Y,(S,x)=>{var O=ze(),H=v(O),pe=v(H,!0);l(H);var Q=u(H,2),de=v(Q);he(de,()=>(e(x),_(()=>e(x).description))),l(Q),l(O),j(()=>A(pe,(e(x),_(()=>e(x).name)))),N(S,O)}),l(t);var y=u(t,2),C=v(y),$=u(C,2);l(y),l(n),l(r),j(()=>{A(m,(e(w),_(()=>e(w).name))),A(k,(e(w),_(()=>e(w).description))),A(b,` ${e(w),_(()=>e(w).primaryAbility)??""}`)}),V("click",p,()=>d(w,null)),V("click",C,()=>d(w,null)),V("click",$,oe),N(s,r)};W(J,s=>{e(w)&&s(le)})}var me=u(J,2);{var ve=s=>{var r=He(),n=v(r),a=v(n),p=u(a,2),t=v(p),o=v(t,!0);l(t);var m=u(t,2),g=v(m);l(m),l(p);var k=u(p,2);l(n);var c=u(n,2);Fe(c,{get features(){return e(D)},get selectionVersion(){return e(L)},get characterStore(){return R},onBumpVersion:()=>_e(L),get featureSelections(){return e(f)},set featureSelections(b){d(f,b)},get expandedFeatures(){return e(E)},set expandedFeatures(b){d(E,b)},$$legacy:!0}),l(r),j(b=>{M(a,"src",(e(i),_(()=>e(i).image))),M(a,"alt",(e(i),_(()=>`${e(i).name} icon`))),A(o,(e(i),_(()=>e(i).name))),A(g,`Average Health: ${b??""}`)},[()=>(e(i),_(()=>ne(e(i).hitDie)))]),V("click",k,re),N(s,r)};W(me,s=>{e(i)&&s(ve)})}l(B),N(te,B),we()}export{rt as component};
