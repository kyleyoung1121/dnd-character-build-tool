import"../chunks/DsnmJJEf.js";import"../chunks/CLB9eUYX.js";import{a as us}from"../chunks/0mxveq2f.js";import{W as _s,j as ue,ar as Ae,as as fs,X as b,au as z,Y as m,Z as xs,d as e,_ as s,v as r,z as _e,$ as o,a0 as t,aP as Ee,ay as q,aO as ms,aw as bs,aQ as Ne}from"../chunks/rn6nHgdH.js";import{g as ys,e as ke,a as p}from"../chunks/ZJQv4x7Q.js";import{i as A}from"../chunks/Co363syM.js";import{e as k,i as T}from"../chunks/CAQU5EIs.js";import{s as hs}from"../chunks/CHpWTfCS.js";import{i as Os}from"../chunks/hD6VUnFp.js";import{c as Ie}from"../chunks/CIqA3WZi.js";import{d as Cs}from"../chunks/BbUdCK9o.js";import{s as fe,b as Te,a as Ds}from"../chunks/u1FZ14JW.js";function $s(){const h=ys(Ie);if(console.log("=== CHARACTER STORE DEBUG ==="),console.log("Skills array:",h.skills),console.log("Provenance data:",h._provenance),h._provenance){console.log(`
=== PROVENANCE ANALYSIS ===`);for(const[d,a]of Object.entries(h._provenance))console.log(`
Scope: ${d}`),"_set"in a&&a._set?(console.log("  _set:",a._set),a._set.skills&&console.log(`  → Added skills: [${a._set.skills.join(", ")}]`)):(console.log("  Flat format:",a),a.skills&&console.log(`  → Added skills: [${a.skills.join(", ")}]`))}console.log(`
=== SKILL SOURCE ANALYSIS ===`);const E={};if(h._provenance)for(const[d,a]of Object.entries(h._provenance)){const $="_set"in a&&a._set?a._set:a;if($&&Array.isArray($.skills))for(const C of $.skills)E[C]||(E[C]={}),E[C][d]=(E[C][d]||0)+1}for(const[d,a]of Object.entries(E)){const $=Object.values(a).reduce((N,F)=>N+F,0);console.log(`${d}:`);for(const[N,F]of Object.entries(a))console.log(`  → ${N}: ${F} instance(s)`);const C=h.skills.filter(N=>N===d).length;console.log(`  📊 Expected: ${$}, Actual: ${C}`),console.log(C!==$?`  ⚠️  MISMATCH: Expected ${$}, found ${C} in skills array`:"  ✅ CORRECT: Instance count matches expectations")}const f={};for(const d of h.skills)f[d]=(f[d]||0)+1;console.log(`
=== DUPLICATE DETECTION ===`);for(const[d,a]of Object.entries(f))a>1&&console.log(`🔴 DUPLICATE: ${d} appears ${a} times`);return{skills:h.skills,provenance:h._provenance,skillSources,duplicates:Object.entries(f).filter(([d,a])=>a>1)}}var ws=b("<li><strong> </strong> </li>"),zs=b("<ul></ul>"),Ss=b("<em>No equipment selected</em>"),As=b('<li class="svelte-1g89zx1"> </li>'),Es=b(" <br/><small> </small>",1),Ns=b("<div><strong> </strong> <!></div>"),ks=b('<li class="svelte-1g89zx1"> </li>'),Ts=b('<div class="access-detail svelte-1g89zx1"><strong> </strong> <br/> <br/> </div>'),Is=b('<details class="svelte-1g89zx1"><summary class="svelte-1g89zx1">Spell Access Details</summary> <!></details>'),Rs=b('<p class="svelte-1g89zx1"><strong>Expertise Already Chosen:</strong> </p>'),Vs=b('<hr/> <p class="svelte-1g89zx1"><strong>Filtering Debug:</strong></p> <p class="svelte-1g89zx1"><strong>Feature:</strong> </p> <p class="svelte-1g89zx1"><strong>Is Expertise Feature:</strong> </p> <p class="svelte-1g89zx1"><strong>Raw Options:</strong> </p> <p class="svelte-1g89zx1"><strong>Already Chosen Here:</strong> </p> <p class="svelte-1g89zx1"><strong>Current Value:</strong> </p> <p class="svelte-1g89zx1"><strong>Taken (blocked):</strong> </p> <!> <p class="svelte-1g89zx1"><strong>Final Filtered Options:</strong> </p>',1),Fs=b('<hr/> <p class="svelte-1g89zx1"><strong>Last Dynamic Options Call:</strong></p> <p class="svelte-1g89zx1"><strong>Generator Type:</strong> </p> <p class="svelte-1g89zx1"><strong>Additional Options:</strong> </p> <p class="svelte-1g89zx1"><strong>Skills from Store:</strong> </p> <p class="svelte-1g89zx1"><strong>Final Options Generated:</strong> </p> <p class="svelte-1g89zx1"><strong>Timestamp:</strong> </p> <!>',1),Ls=b(`<hr/> <p class="svelte-1g89zx1"><em>No dynamic options calls detected yet. Try clicking on a Rogue or Bard Expertise
						dropdown.</em></p>`,1),js=b("<li> </li>"),qs=b('<li style="color: red;"> </li>'),Js=b('<p class="svelte-1g89zx1"><strong>Errors:</strong></p> <ul></ul>',1),Ps=b('<div class="debug-section svelte-1g89zx1"><h2 class="svelte-1g89zx1">🗑️ Class Removal Debug</h2> <div class="debug-info svelte-1g89zx1"><p class="svelte-1g89zx1"><strong>Attempted Class:</strong> </p> <p class="svelte-1g89zx1"><strong>Completed:</strong> </p> <p class="svelte-1g89zx1"><strong>Timestamp:</strong> </p> <p class="svelte-1g89zx1"><strong>Steps:</strong></p> <ul></ul> <!></div></div>'),Bs=b('<div class="main-content svelte-1g89zx1"><h1>Debug & Export Page</h1> <p>This page provides debugging information and data integrity checks.</p> <div class="debug-buttons svelte-1g89zx1"><button style="background: blue; color: white; padding: 10px; margin: 10px;">Debug Conflicts</button> <button style="background: green; color: white; padding: 10px; margin: 10px;">Debug Equipment Proficiencies</button></div> <div class="equipment-debug-section" style="margin: 20px; padding: 20px; background: #f0f0f0; border-radius: 8px;"><h2>⚔️ Equipment Proficiency Debug</h2> <div style="margin: 10px 0;"><strong>Class:</strong> </div> <div style="margin: 10px 0;"><strong>Subclass:</strong> </div> <div style="margin: 10px 0;"><strong>Proficiencies:</strong> </div> <div style="margin: 10px 0;"><strong>Equipment Selections:</strong> <!></div></div> <div class="integrity-section svelte-1g89zx1"><h2>📊 Data Integrity Report</h2> <div class="integrity-grid svelte-1g89zx1"><div class="integrity-card svelte-1g89zx1"><h3 class="svelte-1g89zx1">🪄 Spell Database</h3> <p><strong>Total Spells:</strong> </p> <p><strong>By Level:</strong></p> <ul class="svelte-1g89zx1"></ul></div> <div class="integrity-card svelte-1g89zx1"><h3 class="svelte-1g89zx1">🧙‍♀️ Drow Spells Check</h3> <!></div> <div class="integrity-card svelte-1g89zx1"><h3 class="svelte-1g89zx1">⚙️ Spell Access Config</h3> <p><strong>Total Access Entries:</strong> </p> <p><strong>By Source:</strong></p> <ul class="svelte-1g89zx1"></ul></div> <div class="integrity-card svelte-1g89zx1"><h3 class="svelte-1g89zx1">👤 Current Character</h3> <p><strong>Race:</strong> </p> <p><strong>Subrace:</strong> </p> <p><strong>Class:</strong> </p> <p><strong>Spell Access Entries:</strong> </p> <!></div></div></div> <div class="debug-section svelte-1g89zx1"><h2 class="svelte-1g89zx1">🔧 Dynamic Options Debug</h2> <div class="debug-info svelte-1g89zx1"><p class="svelte-1g89zx1"><strong>Character Skills:</strong> </p> <p class="svelte-1g89zx1"><strong>Character Expertise:</strong> </p> <p class="svelte-1g89zx1"><strong>Character Class:</strong> </p> <p class="svelte-1g89zx1"><strong>Character Features:</strong> </p> <!></div></div> <!> <details class="character-dump svelte-1g89zx1"><summary class="svelte-1g89zx1">Raw Character Data</summary> <pre class="svelte-1g89zx1"> </pre></details></div>');function tt(h,E){_s(E,!1);const f=_e(),d=_e();let a=_e();const $=Ie.subscribe(l=>{ue(a,l)});us($);function C(){console.log("=== MANUAL DEBUG START ===");const l=$s(),n=Cs();return console.log(`
=== CONFLICT DETECTION ===`),console.log("Conflicts:",n),l}function N(){console.log("=== DATA INTEGRITY ANALYSIS ===");const l=fe.length,n=fe.reduce((i,_)=>(i[_.level]=(i[_.level]||0)+1,i),{}),c=["Dancing Lights","Faerie Fire"].map(i=>{const _=fe.find(O=>O.name===i);return{name:i,found:!!_,level:_?.level??"N/A",classes:_?.classes??[]}}),g=Te.length,u=Te.reduce((i,_)=>(i[_.source]=(i[_.source]||0)+1,i),{});let x=[];(e(a).race||e(a).subrace)&&(x=Ds(e(a)));const y={spellDatabase:{totalSpells:l,spellsByLevel:n,drowSpellsAnalysis:c},spellAccessConfig:{totalAccessEntries:g,accessBySource:u},currentCharacter:{race:e(a).race,subrace:e(a).subrace,class:e(a).class,spellAccessEntries:x.length,spellAccessDetails:x.map(i=>({source:i.source,sourceName:i.sourceName,spellCount:i.spells?.length||0,cantripCount:i.cantrips?.length||0,chooseable:i.chooseable}))}};return console.log("Data Integrity Analysis:",y),y}function F(){if(console.log("=== EQUIPMENT PROFICIENCY DEBUG ==="),console.log("Current proficiencies:",e(a).proficiencies),console.log("Class:",e(a).class),console.log("Subclass:",e(a).subclass),e(a)._provenance){const l=Object.keys(e(a)._provenance).filter(n=>n.startsWith("class_equipment_"));console.log("Equipment scopes:",l),l.forEach(n=>{const v=e(a)._provenance[n],c=v._set||v;console.log(`${n}:`,{selectedOption:c.selectedOption,inventory:c.inventory,subChoiceSelections:c.subChoiceSelections})})}}Ae(()=>{},()=>{ue(f,N())}),Ae(()=>e(a),()=>{ue(d,{proficiencies:e(a).proficiencies||[],class:e(a).class||"None",subclass:e(a).subclass||"None",equipmentSelections:e(a)._provenance?Object.keys(e(a)._provenance).filter(l=>l.startsWith("class_equipment_")).map(l=>{const n=e(a)._provenance[l],v=n._set||n;return{scopeId:l,selectedOption:v.selectedOption,inventory:v.inventory||[]}}):[]})}),fs(),Os();var J=Bs(),P=s(o(J),4),xe=o(P),Re=s(xe,2);t(P);var B=s(P,2),Y=s(o(B),2),Ve=s(o(Y));t(Y);var U=s(Y,2),Fe=s(o(U));t(U);var G=s(U,2),Le=s(o(G));t(G);var me=s(G,2),je=s(o(me),2);{var qe=l=>{var n=zs();k(n,5,()=>(e(d),r(()=>e(d).equipmentSelections)),T,(v,c)=>{var g=ws(),u=o(g),x=o(u);t(u);var y=s(u);t(g),z(i=>{p(x,`${e(c),r(()=>e(c).scopeId)??""}:`),p(y,` Option #${e(c),r(()=>e(c).selectedOption!==void 0?e(c).selectedOption:"None")??""},
							Inventory: ${i??""}`)},[()=>(e(c),r(()=>JSON.stringify(e(c).inventory)))]),m(v,g)}),t(n),m(l,n)},Je=l=>{var n=Ss();m(l,n)};A(je,l=>{e(d),r(()=>e(d).equipmentSelections.length>0)?l(qe):l(Je,!1)})}t(me),t(B);var M=s(B,2),be=s(o(M),2),H=o(be),W=s(o(H),2),Pe=s(o(W));t(W);var ye=s(W,4);k(ye,5,()=>(e(f),r(()=>Object.entries(e(f).spellDatabase.spellsByLevel))),T,(l,n)=>{var v=Ee(()=>Ne(e(n),2));let c=()=>e(v)[0],g=()=>e(v)[1];var u=As(),x=o(u);t(u),z(()=>p(x,`Level ${c()??""}: ${g()??""} spells`)),m(l,u)}),t(ye),t(H);var Q=s(H,2),Be=s(o(Q),2);k(Be,1,()=>(e(f),r(()=>e(f).spellDatabase.drowSpellsAnalysis)),T,(l,n)=>{var v=Ns(),c=o(v),g=o(c);t(c);var u=s(c,2);{var x=i=>{var _=Es(),O=q(_),I=s(O,2),w=o(I);t(I),z(S=>{p(O,`✅ Found (Level ${e(n),r(()=>e(n).level)??""}) `),p(w,`Classes: ${S??""}`)},[()=>(e(n),r(()=>e(n).classes.join(", ")))]),m(i,_)},y=i=>{var _=ms("❌ Missing");m(i,_)};A(u,i=>{e(n),r(()=>e(n).found)?i(x):i(y,!1)})}t(v),z(()=>{hs(v,1,`spell-check ${e(n),r(()=>e(n).found?"found":"missing")??""}`,"svelte-1g89zx1"),p(g,`${e(n),r(()=>e(n).name)??""}:`)}),m(l,v)}),t(Q);var K=s(Q,2),X=s(o(K),2),Ye=s(o(X));t(X);var he=s(X,4);k(he,5,()=>(e(f),r(()=>Object.entries(e(f).spellAccessConfig.accessBySource))),T,(l,n)=>{var v=Ee(()=>Ne(e(n),2));let c=()=>e(v)[0],g=()=>e(v)[1];var u=ks(),x=o(u);t(u),z(()=>p(x,`${c()??""}: ${g()??""} entries`)),m(l,u)}),t(he),t(K);var Oe=s(K,2),Z=s(o(Oe),2),Ue=s(o(Z));t(Z);var ee=s(Z,2),Ge=s(o(ee));t(ee);var se=s(ee,2),Me=s(o(se));t(se);var te=s(se,2),He=s(o(te));t(te);var We=s(te,2);{var Qe=l=>{var n=Is(),v=s(o(n),2);k(v,1,()=>(e(f),r(()=>e(f).currentCharacter.spellAccessDetails)),T,(c,g)=>{var u=Ts(),x=o(u),y=o(x,!0);t(x);var i=s(x),_=s(i,2),O=s(_,2);t(u),z(()=>{p(y,(e(g),r(()=>e(g).sourceName))),p(i,` (${e(g),r(()=>e(g).source)??""}) `),p(_,`Spells: ${e(g),r(()=>e(g).spellCount)??""}, Cantrips: ${e(g),r(()=>e(g).cantripCount)??""} `),p(O,`Chooseable: ${e(g),r(()=>e(g).chooseable?"Yes":"No")??""}`)}),m(c,u)}),t(n),m(l,n)};A(We,l=>{e(f),r(()=>e(f).currentCharacter.spellAccessDetails.length>0)&&l(Qe)})}t(Oe),t(be),t(M);var re=s(M,2),Ce=s(o(re),2),ae=o(Ce),Ke=s(o(ae));t(ae);var oe=s(ae,2),Xe=s(o(oe));t(oe);var ne=s(oe,2),Ze=s(o(ne));t(ne);var le=s(ne,2),es=s(o(le));t(le);var ss=s(le,2);{var ts=l=>{var n=Fs(),v=s(q(n),4),c=s(o(v));c.nodeValue=` ${r(()=>window.dynamicOptionsDebug.lastCall?.generatorType||"None")??""}`,t(v);var g=s(v,2),u=s(o(g));u.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.lastCall?.additionalOptions||[]))??""}`,t(g);var x=s(g,2),y=s(o(x));y.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.lastCall?.skillsArray||[]))??""}`,t(x);var i=s(x,2),_=s(o(i));_.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.lastCall?.finalOptions||[]))??""}`,t(i);var O=s(i,2),I=s(o(O));I.nodeValue=` ${r(()=>window.dynamicOptionsDebug.lastCall?.timestamp||"Never")??""}`,t(O);var w=s(O,2);{var S=D=>{var R=Vs(),V=s(q(R),4),L=s(o(V));L.nodeValue=` ${r(()=>window.dynamicOptionsDebug.filtering.featureName)??""} (index ${r(()=>window.dynamicOptionsDebug.filtering.index)??""})`,t(V);var j=s(V,2),ns=s(o(j));ns.nodeValue=` ${r(()=>window.dynamicOptionsDebug.filtering.isExpertiseFeature?"Yes":"No")??""}`,t(j);var ie=s(j,2),ls=s(o(ie));ls.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.filtering.rawOptions||[]))??""}`,t(ie);var ce=s(ie,2),is=s(o(ce));is.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.filtering.chosenHere||[]))??""}`,t(ce);var ve=s(ce,2),cs=s(o(ve));cs.nodeValue=` ${r(()=>window.dynamicOptionsDebug.filtering.currentValue||"null")??""}`,t(ve);var ge=s(ve,2),vs=s(o(ge));vs.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.filtering.taken||[]))??""}`,t(ge);var ze=s(ge,2);{var gs=pe=>{var de=Rs(),ds=s(o(de));ds.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.filtering.expertiseAlreadyChosen||[]))??""}`,t(de),m(pe,de)};A(ze,pe=>{r(()=>window.dynamicOptionsDebug.filtering.isExpertiseFeature)&&pe(gs)})}var Se=s(ze,2),ps=s(o(Se));ps.nodeValue=` ${r(()=>JSON.stringify(window.dynamicOptionsDebug.filtering.finalFiltered||[]))??""}`,t(Se),m(D,R)};A(w,D=>{r(()=>window.dynamicOptionsDebug.filtering)&&D(S)})}m(l,n)},rs=l=>{var n=Ls();bs(2),m(l,n)};A(ss,l=>{r(()=>typeof window<"u"&&window.dynamicOptionsDebug)?l(ts):l(rs,!1)})}t(Ce),t(re);var De=s(re,2);{var as=l=>{var n=Ps(),v=s(o(n),2),c=o(v),g=s(o(c));g.nodeValue=` ${r(()=>window.classRemovalDebug.attemptedClass)??""}`,t(c);var u=s(c,2),x=s(o(u));x.nodeValue=` ${r(()=>window.classRemovalDebug.completed?"Yes":"No")??""}`,t(u);var y=s(u,2),i=s(o(y));i.nodeValue=` ${r(()=>window.classRemovalDebug.timestamp)??""}`,t(y);var _=s(y,4);k(_,4,()=>r(()=>window.classRemovalDebug.steps||[]),T,(w,S)=>{var D=js(),R=o(D,!0);t(D),z(()=>p(R,S)),m(w,D)}),t(_);var O=s(_,2);{var I=w=>{var S=Js(),D=s(q(S),2);k(D,4,()=>r(()=>window.classRemovalDebug.revertErrors),T,(R,V)=>{var L=qs(),j=o(L);t(L),z(()=>p(j,`${r(()=>V.key)??""}: ${r(()=>V.error)??""}`)),m(R,L)}),t(D),m(w,S)};A(O,w=>{r(()=>window.classRemovalDebug.revertErrors&&window.classRemovalDebug.revertErrors.length>0)&&w(I)})}t(v),t(n),m(l,n)};A(De,l=>{r(()=>typeof window<"u"&&window.classRemovalDebug)&&l(as)})}var $e=s(De,2),we=s(o($e),2),os=o(we,!0);t(we),t($e),t(J),z((l,n,v,c,g)=>{p(Ve,` ${e(d),r(()=>e(d).class)??""}`),p(Fe,` ${e(d),r(()=>e(d).subclass)??""}`),p(Le,` ${l??""}`),p(Pe,` ${e(f),r(()=>e(f).spellDatabase.totalSpells)??""}`),p(Ye,` ${e(f),r(()=>e(f).spellAccessConfig.totalAccessEntries)??""}`),p(Ue,` ${e(a),r(()=>e(a).race||"None")??""}`),p(Ge,` ${e(a),r(()=>e(a).subrace||"None")??""}`),p(Me,` ${e(a),r(()=>e(a).class||"None")??""}`),p(He,` ${e(f),r(()=>e(f).currentCharacter.spellAccessEntries)??""}`),p(Ke,` ${n??""}`),p(Xe,` ${v??""}`),p(Ze,` ${e(a),r(()=>e(a).class||"None")??""}`),p(es,` ${c??""}`),p(os,g)},[()=>(e(d),r(()=>JSON.stringify(e(d).proficiencies))),()=>(e(a),r(()=>JSON.stringify(e(a).skills||[]))),()=>(e(a),r(()=>JSON.stringify(e(a).expertise||[]))),()=>(e(a),r(()=>JSON.stringify(e(a).features||[]))),()=>(e(a),r(()=>JSON.stringify(e(a),null,2)))]),ke("click",xe,C),ke("click",Re,F),m(h,J),xs()}export{tt as component};
